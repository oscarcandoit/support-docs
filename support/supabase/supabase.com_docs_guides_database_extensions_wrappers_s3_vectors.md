---
url: "https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors"
title: "AWS S3 Vectors | Supabase Docs"
---

[![Supabase wordmark](https://supabase.com/docs/supabase-dark.svg)![Supabase wordmark](https://supabase.com/docs/supabase-light.svg)DOCS](https://supabase.com/docs)

- [Start](https://supabase.com/docs/guides/getting-started)
- Products
- Build
- Manage
- Reference
- Resources

[![Supabase wordmark](https://supabase.com/docs/supabase-dark.svg)![Supabase wordmark](https://supabase.com/docs/supabase-light.svg)DOCS](https://supabase.com/docs)

Search docs...

K

[Sign up](https://supabase.com/dashboard)

Main menu

[Database](https://supabase.com/docs/guides/database/overview)

[Overview](https://supabase.com/docs/guides/database/overview)

Fundamentals[Connecting to your database](https://supabase.com/docs/guides/database/connecting-to-postgres)
[Importing data](https://supabase.com/docs/guides/database/import-data)
[Securing your data](https://supabase.com/docs/guides/database/secure-data)

Working with your database (basics)[Managing tables, views, and data](https://supabase.com/docs/guides/database/tables)
[Working with arrays](https://supabase.com/docs/guides/database/arrays)
[Managing indexes](https://supabase.com/docs/guides/database/postgres/indexes)
[Querying joins and nested tables](https://supabase.com/docs/guides/database/joins-and-nesting)
[JSON and unstructured data](https://supabase.com/docs/guides/database/json)

Working with your database (intermediate)[Implementing cascade deletes](https://supabase.com/docs/guides/database/postgres/cascade-deletes)
[Managing enums](https://supabase.com/docs/guides/database/postgres/enums)
[Managing database functions](https://supabase.com/docs/guides/database/functions)
[Managing database triggers](https://supabase.com/docs/guides/database/postgres/triggers)
[Managing database webhooks](https://supabase.com/docs/guides/database/webhooks)
[Using Full Text Search](https://supabase.com/docs/guides/database/full-text-search)
[Partitioning your tables](https://supabase.com/docs/guides/database/partitions)
[Managing connections](https://supabase.com/docs/guides/database/connection-management)
[Managing event triggers](https://supabase.com/docs/guides/database/postgres/event-triggers)

OrioleDB[Overview](https://supabase.com/docs/guides/database/orioledb)

Access and security[Row Level Security](https://supabase.com/docs/guides/database/postgres/row-level-security)
[Column Level Security](https://supabase.com/docs/guides/database/postgres/column-level-security)
[Hardening the Data API](https://supabase.com/docs/guides/database/hardening-data-api)
[Custom Claims & RBAC](https://supabase.com/docs/guides/database/postgres/custom-claims-and-role-based-access-control-rbac)
[Managing Postgres Roles](https://supabase.com/docs/guides/database/postgres/roles)
[Using Custom Postgres Roles](https://supabase.com/docs/guides/storage/schema/custom-roles)
[Managing secrets with Vault](https://supabase.com/docs/guides/database/vault)
[Superuser Access and Unsupported Operations](https://supabase.com/docs/guides/database/postgres/roles-superuser)

Configuration, optimization, and testing[Database configuration](https://supabase.com/docs/guides/database/postgres/configuration)
[Query optimization](https://supabase.com/docs/guides/database/query-optimization)
[Database Advisors](https://supabase.com/docs/guides/database/database-advisors)
[Testing your database](https://supabase.com/docs/guides/database/testing)
[Customizing Postgres config](https://supabase.com/docs/guides/database/custom-postgres-config)

Debugging[Timeouts](https://supabase.com/docs/guides/database/postgres/timeouts)
[Debugging and monitoring](https://supabase.com/docs/guides/database/inspect)
[Debugging performance issues](https://supabase.com/docs/guides/database/debugging-performance)
[Supavisor](https://supabase.com/docs/guides/database/supavisor)
[Troubleshooting](https://supabase.com/docs/guides/database/troubleshooting)

ORM Quickstarts

Prisma

[Drizzle](https://supabase.com/docs/guides/database/drizzle)
[Postgres.js](https://supabase.com/docs/guides/database/postgres-js)

GUI quickstarts[pgAdmin](https://supabase.com/docs/guides/database/pgadmin)
[PSQL](https://supabase.com/docs/guides/database/psql)
[DBeaver](https://supabase.com/docs/guides/database/dbeaver)
[Metabase](https://supabase.com/docs/guides/database/metabase)
[Beekeeper Studio](https://supabase.com/docs/guides/database/beekeeper-studio)

Database replication[Overview](https://supabase.com/docs/guides/database/replication)

Replication

Manual replication

Extensions[Overview](https://supabase.com/docs/guides/database/extensions)
[HypoPG: Hypothetical indexes](https://supabase.com/docs/guides/database/extensions/hypopg)
[plv8 (deprecated)](https://supabase.com/docs/guides/database/extensions/plv8)
[http: RESTful Client](https://supabase.com/docs/guides/database/extensions/http)
[index\_advisor: Query optimization](https://supabase.com/docs/guides/database/extensions/index_advisor)
[PGAudit: Postgres Auditing](https://supabase.com/docs/guides/database/extensions/pgaudit)
[pgjwt (deprecated)](https://supabase.com/docs/guides/database/extensions/pgjwt)
[PGroonga: Multilingual Full Text Search](https://supabase.com/docs/guides/database/extensions/pgroonga)
[pgRouting: Geospatial Routing](https://supabase.com/docs/guides/database/extensions/pgrouting)
[pg\_cron: Schedule Recurring Jobs](https://supabase.com/docs/guides/database/extensions/pg_cron)
[pg\_graphql: GraphQL Support](https://supabase.com/docs/guides/database/extensions/pg_graphql)
[pg\_hashids: Short UIDs](https://supabase.com/docs/guides/database/extensions/pg_hashids)
[pg\_jsonschema: JSON Schema Validation](https://supabase.com/docs/guides/database/extensions/pg_jsonschema)
[pg\_net: Async Networking](https://supabase.com/docs/guides/database/extensions/pg_net)
[pg\_plan\_filter: Restrict Total Cost](https://supabase.com/docs/guides/database/extensions/pg_plan_filter)
[postgres\_fdw: query data from an external Postgres server](https://supabase.com/docs/guides/database/extensions/postgres_fdw)
[pgvector: Embeddings and vector similarity](https://supabase.com/docs/guides/database/extensions/pgvector)
[pg\_stat\_statements: SQL Planning and Execution Statistics](https://supabase.com/docs/guides/database/extensions/pg_stat_statements)
[pg\_repack: Storage Optimization](https://supabase.com/docs/guides/database/extensions/pg_repack)
[PostGIS: Geo queries](https://supabase.com/docs/guides/database/extensions/postgis)
[pgmq: Queues](https://supabase.com/docs/guides/database/extensions/pgmq)
[pgsodium (pending deprecation): Encryption Features](https://supabase.com/docs/guides/database/extensions/pgsodium)
[pgTAP: Unit Testing](https://supabase.com/docs/guides/database/extensions/pgtap)
[plpgsql\_check: PL/pgSQL Linter](https://supabase.com/docs/guides/database/extensions/plpgsql_check)
[timescaledb (deprecated)](https://supabase.com/docs/guides/database/extensions/timescaledb)
[uuid-ossp: Unique Identifiers](https://supabase.com/docs/guides/database/extensions/uuid-ossp)
[RUM: inverted index for full-text search](https://supabase.com/docs/guides/database/extensions/rum)

Foreign Data Wrappers[Overview](https://supabase.com/docs/guides/database/extensions/wrappers/overview)
[Connecting to Auth0](https://supabase.com/docs/guides/database/extensions/wrappers/auth0)
[Connecting to Airtable](https://supabase.com/docs/guides/database/extensions/wrappers/airtable)
[Connecting to AWS Cognito](https://supabase.com/docs/guides/database/extensions/wrappers/cognito)
[Connecting to AWS S3](https://supabase.com/docs/guides/database/extensions/wrappers/s3)
[Connecting to AWS S3 Vectors](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors)
[Connecting to BigQuery](https://supabase.com/docs/guides/database/extensions/wrappers/bigquery)
[Connecting to Clerk](https://supabase.com/docs/guides/database/extensions/wrappers/clerk)
[Connecting to ClickHouse](https://supabase.com/docs/guides/database/extensions/wrappers/clickhouse)
[Connecting to DuckDB](https://supabase.com/docs/guides/database/extensions/wrappers/duckdb)
[Connecting to Firebase](https://supabase.com/docs/guides/database/extensions/wrappers/firebase)
[Connecting to Iceberg](https://supabase.com/docs/guides/database/extensions/wrappers/iceberg)
[Connecting to Logflare](https://supabase.com/docs/guides/database/extensions/wrappers/logflare)
[Connecting to MSSQL](https://supabase.com/docs/guides/database/extensions/wrappers/mssql)
[Connecting to Notion](https://supabase.com/docs/guides/database/extensions/wrappers/notion)
[Connecting to Paddle](https://supabase.com/docs/guides/database/extensions/wrappers/paddle)
[Connecting to Redis](https://supabase.com/docs/guides/database/extensions/wrappers/redis)
[Connecting to Snowflake](https://supabase.com/docs/guides/database/extensions/wrappers/snowflake)
[Connecting to Stripe](https://supabase.com/docs/guides/database/extensions/wrappers/stripe)

Examples[Drop All Tables in Schema](https://supabase.com/docs/guides/database/postgres/dropping-all-tables-in-schema)
[Select First Row per Group](https://supabase.com/docs/guides/database/postgres/first-row-in-group)
[Print PostgreSQL Version](https://supabase.com/docs/guides/database/postgres/which-version-of-postgres)
[Replicating from Supabase to External Postgres](https://supabase.com/docs/guides/database/postgres/setup-replication-external)

[![Supabase wordmark](https://supabase.com/docs/supabase-dark.svg)![Supabase wordmark](https://supabase.com/docs/supabase-light.svg)DOCS](https://supabase.com/docs)

- [Start](https://supabase.com/docs/guides/getting-started)
- Products
- Build
- Manage
- Reference
- Resources

[![Supabase wordmark](https://supabase.com/docs/supabase-dark.svg)![Supabase wordmark](https://supabase.com/docs/supabase-light.svg)DOCS](https://supabase.com/docs)

Search docs...

K

[Sign up](https://supabase.com/dashboard)

Database

1. [Database](https://supabase.com/docs/guides/database/overview)
3. Foreign Data Wrappers
5. [Connecting to AWS S3 Vectors](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors)

# AWS S3 Vectors

* * *

You can enable the AWS S3 Vectors wrapper right from the Supabase dashboard.

[Open wrapper in dashboard](https://supabase.com/dashboard/project/_/integrations/s3_vectors_wrapper/overview)

[AWS S3 Vectors](https://aws.amazon.com/s3/features/vectors/) is a managed service that stores and queries high-dimensional vectors at scale, optimized for machine learning and artificial intelligence applications.

The S3 Vectors Wrapper allows you to read, write, and perform vector similarity search operations on S3 Vectors within your Postgres database.

## Preparation [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#preparation)

Before you can query S3 Vectors, you need to enable the Wrappers extension and store your credentials in Postgres.

### Enable Wrappers [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#enable-wrappers)

Make sure the `wrappers` extension is installed on your database:

```
1

create extension if not exists wrappers with schema extensions;
```

### Enable the S3 Vectors Wrapper [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#enable-the-s3-vectors-wrapper)

Enable the `s3_vectors_wrapper` FDW:

```
1
2
3

create foreign data wrapper s3_vectors_wrapper  handler s3_vectors_fdw_handler  validator s3_vectors_fdw_validator;
```

### Store your credentials (optional) [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#store-your-credentials-optional)

By default, Postgres stores FDW credentials inside `pg_catalog.pg_foreign_server` in plain text. Anyone with access to this table will be able to view these credentials. Wrappers is designed to work with [Vault](https://supabase.com/docs/guides/database/vault), which provides an additional level of security for storing credentials. We recommend using Vault to store your credentials.

```
1
2
3
4
5
6
7
8
9
10
11
12

-- Save your AWS credentials in Vault and retrieve the created-- `vault_access_key_id` and `vault_secret_access_key`select vault.create_secret(  '<access key id>',  -- secret to be encrypted  'vault_access_key_id',  -- secret name  'AWS access key for Wrappers'  -- secret description);select vault.create_secret(  '<secret access key>',  'vault_secret_access_key',  'AWS secret access key for Wrappers');
```

### Connecting to S3 Vectors [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#connecting-to-s3-vectors)

We need to provide Postgres with the credentials to connect to S3 Vectors. We can do this using the `create server` command.

With VaultWithout Vault

```
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

create server s3_vectors_server  foreign data wrapper s3_vectors_wrapper  options (    -- The key id saved in Vault from above    vault_access_key_id '<key_ID>',    -- The secret id saved in Vault from above    vault_secret_access_key '<secret_key>',    -- AWS region    aws_region 'us-east-1',    -- Optional: Custom endpoint URL for alternative S3 services    endpoint_url 'http://localhost:8080'  );
```

### Create a schema [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#create-a-schema)

We recommend creating a schema to hold all the foreign tables:

```
1

create schema if not exists s3_vectors;
```

## Options [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#options)

The full list of foreign table options are below:

- `bucket_name` \- The name of the S3 Vector bucket, required.
- `index_name` \- The name of the S3 Vector index, required.
- `rowid_column` \- The column to use as the row identifier for INSERT/DELETE operations, required.

## Entities [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#entities)

We can use SQL [import foreign schema](https://www.postgresql.org/docs/current/sql-importforeignschema.html) to import foreign table definitions from S3 Vectors.

For example, using below SQL can automatically create foreign tables in the `s3_vectors` schema.

```
1
2
3
4
5
6

-- create foreign table for each index from S3 Vector bucketimport foreign schema s3_vectors  from server s3_vectors_server into s3_vectors  options (    bucket_name 'my-vector-bucket'  );
```

### S3 Vector Tables [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#s3-vector-tables)

This is an object representing S3 Vector index.

Ref: [S3 Vectors API Reference](https://docs.aws.amazon.com/AmazonS3/latest/API/API_Operations_Amazon_S3_Vectors.html)

#### Operations [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#operations)

| Object | Select | Insert | Update | Delete | Truncate |
| --- | :-: | :-: | :-: | :-: | :-: |
| table | ✅ | ✅ | ❌ | ✅ | ❌ |

#### Usage [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#usage)

You can also manually create the foreign table like below if you did not use `import foreign schema`.

```
1
2
3
4
5
6
7
8
9
10
11

create foreign table s3_vectors.embeddings (  key text not null,  data embd not null,  metadata jsonb)  server s3_vectors_server  options (    bucket_name 'my-vector-bucket',    index_name 'my-vector-index',    rowid_column 'key'  );
```

### Custom Data Types [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#custom-data-types)

#### embd [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#embd)

The `embd` type is a custom PostgreSQL data type designed to store and work with high-dimensional vectors for machine learning and AI applications.

**Structure:**

The `embd` type internally contains:

- Vector data as an array of 32-bit floating point numbers (Float32)
- Additional metadata fields for internal use

**Input Formats:**

The `embd` type accepts input in JSON array format:

```
1
2
3
4
5

-- Simple array format (most common)'[0.1, 0.2, 0.3, 0.4, 0.5]'::embd-- Full JSON object format (advanced)'{"data": [0.1, 0.2, 0.3], "key": "vector_001"}'::embd
```

**Output Format:**

When displayed, the `embd` type shows a summary format:

```
1

embd:5  -- indicates an embedding with 5 dimensions
```

**Usage Examples:**

See the following sections for complete examples:

- [Inserting Vectors](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#inserting-vectors) \- Examples of inserting data with `embd` type
- [Querying Vectors](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#querying-vectors) \- Basic queries and vector similarity search
- [Vector Similarity Search with Filtering](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#vector-similarity-search-with-filtering) \- Advanced search with metadata filtering
- [Advanced Example: Semantic Search](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#advanced-example-semantic-search) \- Complete semantic search implementation

**Operations:**

- **Vector similarity search**: Use the `<==>` operator for approximate nearest neighbor search
- **Distance calculation**: Use `embd_distance()` function to get similarity scores
- **Type casting**: Convert JSON arrays to `embd` type using `::embd` cast

**Constraints:**

- Only supports 32-bit floating point vectors (Float32)
- Vector dimensions should be consistent within the same index
- Cannot be null when used as vector data in S3 Vectors tables

### Functions [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#functions)

#### embd\_distance(embd) [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#embd_distanceembd)

Returns the distance score from the most recent vector similarity search operation.

**Syntax:**

```
1

embd_distance(vector_data) -> real
```

**Parameters:**

- `vector_data` \- An `embd` type column containing vector data

**Returns:**

- `real` \- The distance score from the vector similarity search. This value is only meaningful when used in queries with the `<==>` operator for vector similarity search.

**Usage:**

```
1
2
3
4
5
6

-- Get similarity search results with distance scoresselect embd_distance(data) as distance, key, metadatafrom s3_vectors.embeddingswhere data <==> '[0.1, 0.2, 0.3, 0.4, 0.5]'::embdorder by 1limit 5;
```

**Notes:**

- The distance value is only populated during vector similarity search operations using the `<==>` operator
- For other query types (key-based lookups, list all), the distance will be 0.0
- Lower distance values indicate higher similarity

## Query Pushdown Support [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#query-pushdown-support)

This FDW supports limited query pushdown with specific operators based on the type of operation:

### Vector Similarity Search (ANN) [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#vector-similarity-search-ann)

For approximate nearest neighbor search using the `<==>` operator:

| Operation | Note |
| --- | --- |
| `data <==> vector_value` | Vector similarity search with embeddings |
| `metadata <==> json_filter` | Metadata filtering using S3 Vectors filter expressions |

**Metadata Filtering Syntax:**

The `json_filter` uses S3 Vectors metadata filtering expressions with the following operators:

- **Equality**: `$eq`, `$ne` \- Exact match or not equal
- **Numeric Comparisons**: `$gt`, `$gte`, `$lt`, `$lte` \- Greater than, less than comparisons
- **Array Operations**: `$in`, `$nin` \- Match any/none of the values in array
- **Existence Check**: `$exists` \- Check if field exists
- **Logical Operations**: `$and`, `$or` \- Combine multiple conditions

**Examples:**

```
1
2
3
4
5
6
7
8
9
10
11

-- Simple equalitymetadata <==> '{"category": "electronics"}'::jsonb-- Numeric rangemetadata <==> '{"price": {"$gte": 100, "$lte": 500}}'::jsonb-- Array matchingmetadata <==> '{"tags": {"$in": ["popular", "trending"]}}'::jsonb-- Complex logical conditionsmetadata <==> '{"$and": [{"category": "books"}, {"year": {"$gte": 2020}}]}'::jsonb
```

For more details on metadata filtering syntax, see the [AWS S3 Vectors metadata filtering documentation](https://docs.aws.amazon.com/AmazonS3/latest/userguide/s3-vectors-metadata-filtering.html).

### Key-based Queries [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#key-based-queries)

For exact key lookups:

| Operation | Note |
| --- | --- |
| `key = 'value'` | Exact key match |
| `key in ('val1', 'val2')` | Multiple key lookup |

### Supported Query Patterns [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#supported-query-patterns)

1. **List all vectors** (no WHERE clause):



```
1

select * from s3_vectors.embeddings;
```

2. **Get a specific vector by key**:



```
1

select * from s3_vectors.embeddings where key = 'vector_001';
```

3. **Vector similarity search**:



```
1
2
3
4
5

select embd_distance(data) as distance, *from s3_vectors.embeddingswhere data <==> '[0.1, 0.2, 0.3, ...]'::embdorder by 1limit 10;
```

4. **Vector search with metadata filtering**:



```
1
2
3
4
5
6

select embd_distance(data) as distance, *from s3_vectors.embeddingswhere data <==> '[0.1, 0.2, 0.3, ...]'::embdand metadata <==> '{"category": "product"}'::jsonborder by 1limit 5;
```


Only above specific query patterns are supported. Complex queries with unsupported operators or combinations may result in errors.

## Supported Data Types [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#supported-data-types)

| Postgres Type | S3 Vectors Type |
| --- | --- |
| text | String (for vector key) |
| embd | Float32 vector data |
| jsonb | Document metadata |

## Limitations [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#limitations)

This section describes important limitations and considerations when using this FDW:

- Only supports specific query patterns as described in the Query Pushdown section
- Vector similarity search is limited to Float32 vectors
- UPDATE operations are not supported (use DELETE + INSERT instead)
- Complex WHERE clauses with AND/OR combinations are not supported except for specific vector search patterns
- Materialized views using these foreign tables may fail during logical backups

## Examples [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#examples)

### Basic Setup [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#basic-setup)

First, create a server for S3 Vectors:

```
1
2
3
4
5
6
7

create server s3_vectors_server  foreign data wrapper s3_vectors_wrapper  options (    aws_access_key_id '<AWS_access_key_ID>',    aws_secret_access_key '<AWS_secret_access_key>',    aws_region 'us-east-1'  );
```

Import the foreign table:

```
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19

-- Import all indexes from a vector bucketimport foreign schema s3_vectors  from server s3_vectors_server into s3_vectors  options (    bucket_name 'my-vector-bucket'  );-- or, create the foreign table manuallycreate foreign table if not exists s3_vectors.embeddings (  key text not null,  data embd not null,  metadata jsonb)  server s3_vectors_server  options (    bucket_name 'my-vector-bucket',    index_name 'my-vector-index',    rowid_column 'key'  );
```

### Querying Vectors [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#querying-vectors)

```
1
2
3
4
5
6
7
8
9
10
11
12

-- List all vectors in an indexselect * from s3_vectors.embeddings;-- Get specific vector by keyselect * from s3_vectors.embeddings where key = 'product_001';-- Vector similarity search (top 5 similar vectors)select embd_distance(data) as distance, key, metadatafrom s3_vectors.embeddingswhere data <==> '[0.1, 0.2, 0.3, 0.4, 0.5]'::embdorder by 1limit 5;
```

### Inserting Vectors [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#inserting-vectors)

```
1
2
3
4
5
6
7
8
9
10
11
12
13

-- Insert a single vectorinsert into s3_vectors.embeddings (key, data, metadata)values (  'product_001',  '[0.1, 0.2, 0.3, 0.4, 0.5]'::embd,  '{"category": "electronics", "price": 299.99}'::jsonb);-- Insert multiple vectorsinsert into s3_vectors.embeddings (key, data, metadata)values  ('product_002', '[0.2, 0.3, 0.4, 0.5, 0.6]'::embd, '{"category": "books"}'::jsonb),  ('product_003', '[0.3, 0.4, 0.5, 0.6, 0.7]'::embd, '{"category": "clothing"}'::jsonb);
```

### Deleting Vectors [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#deleting-vectors)

```
1
2
3
4
5

-- Delete a specific vector by keydelete from s3_vectors.embeddings where key = 'product_001';-- Delete all vectorsdelete from s3_vectors.embeddings;
```

### Vector Similarity Search with Filtering [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#vector-similarity-search-with-filtering)

```
1
2
3
4
5
6
7

-- Find similar vectors with metadata filteringselect embd_distance(data) as distance, key, metadatafrom s3_vectors.embeddingswhere data <==> '[0.1, 0.2, 0.3, 0.4, 0.5]'::embdand metadata <==> '{"category": "electronics"}'::jsonborder by 1limit 3;
```

### Advanced Example: Semantic Search [\#](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors\#advanced-example-semantic-search)

```
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17

-- Create a function to convert text to embeddings (pseudo-code)-- This would typically use an external embedding servicecreate or replace function text_to_embedding(input_text text)returns embdlanguage sqlas $$  -- This is a placeholder - you would implement actual text embedding logic  select '[0.1, 0.2, 0.3, 0.4, 0.5]'::embd;$$;-- Semantic search exampleselect embd_distance(data) as distance, key, metadatafrom s3_vectors.embeddingswhere data <==> text_to_embedding('Find similar products')and metadata <==> '{"status": "active"}'::jsonborder by 1limit 10;
```

[Edit this page on GitHub](https://github.com/supabase/wrappers/blob/docs_v0.5.6/docs/catalog/s3vectors.md)

### Is this helpful?

NoYes

### On this page

[Preparation](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#preparation) [Enable Wrappers](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#enable-wrappers) [Enable the S3 Vectors Wrapper](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#enable-the-s3-vectors-wrapper) [Store your credentials (optional)](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#store-your-credentials-optional) [Connecting to S3 Vectors](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#connecting-to-s3-vectors) [Create a schema](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#create-a-schema) [Options](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#options) [Entities](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#entities) [S3 Vector Tables](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#s3-vector-tables) [Custom Data Types](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#custom-data-types) [Functions](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#functions) [Query Pushdown Support](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#query-pushdown-support) [Vector Similarity Search (ANN)](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#vector-similarity-search-ann) [Key-based Queries](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#key-based-queries) [Supported Query Patterns](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#supported-query-patterns) [Supported Data Types](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#supported-data-types) [Limitations](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#limitations) [Examples](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#examples) [Basic Setup](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#basic-setup) [Querying Vectors](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#querying-vectors) [Inserting Vectors](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#inserting-vectors) [Deleting Vectors](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#deleting-vectors) [Vector Similarity Search with Filtering](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#vector-similarity-search-with-filtering) [Advanced Example: Semantic Search](https://supabase.com/docs/guides/database/extensions/wrappers/s3_vectors#advanced-example-semantic-search)

- Need some help?
[Contact support](https://supabase.com/support)
- Latest product updates?
[See Changelog](https://supabase.com/changelog)
- Something's not right?
[Check system status](https://status.supabase.com/)

* * *

[© Supabase Inc](https://supabase.com/)— [Contributing](https://github.com/supabase/supabase/blob/master/apps/docs/DEVELOPERS.md) [Author Styleguide](https://github.com/supabase/supabase/blob/master/apps/docs/CONTRIBUTING.md) [Open Source](https://supabase.com/open-source) [SupaSquad](https://supabase.com/supasquad) Privacy Settings

[Twitter](https://twitter.com/supabase) [GitHub](https://github.com/supabase) [Discord](https://discord.supabase.com/) [Youtube](https://youtube.com/c/supabase)