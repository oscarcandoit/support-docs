---
url: "https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-protocol-issues/"
title: "How to Troubleshoot SSH Protocol Issues | DigitalOcean Documentation"
---

- [DigitalOcean \| Docs](https://docs.digitalocean.com/)

- [Platform](https://docs.digitalocean.com/platform/)
- [Products](https://docs.digitalocean.com/products/)
- [Reference](https://docs.digitalocean.com/reference/)
- [Support](https://docs.digitalocean.com/support/)
- [Sign Up](https://cloud.digitalocean.com/registrations/new)

- [Support Home](https://docs.digitalocean.com/support/)
- [![](https://docs.digitalocean.com/images/icons/accounts.7c3a46a4e139957c37b1ba530846464f3b7432b7bc00793db0d8e788940ddf69.svg)Accounts](https://docs.digitalocean.com/support/accounts/)
- [![](https://docs.digitalocean.com/images/icons/api.47c17d0d57a6ef27c2bdc744b3a7b71edc80838dfbe8431e12f5c3e81f371510.svg)API](https://docs.digitalocean.com/support/api/)
- [![](https://docs.digitalocean.com/images/icons/app-platform.965eeb0520b4c178cc9bf64423065e5aa5c2f47ad6102384e37beca3c079f287.svg)App Platform](https://docs.digitalocean.com/support/app-platform/)
- [![](https://docs.digitalocean.com/images/icons/backups.8f2953b640369857d8e09577aab7309b64ba37e4be8cbad0f0514549bf449bd6.svg)Backups](https://docs.digitalocean.com/support/backups/)
- [![](https://docs.digitalocean.com/images/icons/bare-metal-gpus.7498b79d7a8142afb95399794d7f631c490388aa4fb5b30d9021292dca01d125.svg)Bare Metal GPUs](https://docs.digitalocean.com/support/bare-metal-gpus/)
- [![](https://docs.digitalocean.com/images/icons/billing.357b31651da85802e1aa1c9f0b19cda7b26d5c971352f7176d1a130b21e088b7.svg)Billing](https://docs.digitalocean.com/support/billing/)
- [![](https://docs.digitalocean.com/images/icons/cloudways.4200c764fb56e3bab6adc9c1009bfd314c9c555e4583882b57f4a571a854ac89.svg)Cloudways](https://docs.digitalocean.com/support/cloudways/)
- [![](https://docs.digitalocean.com/images/icons/support.91273ef64796cbf92aa09b42996c4fd5bae614b3ce3dd81c685d8da10c28f209.svg)Container Registry](https://docs.digitalocean.com/support/container-registry/)
- [![](https://docs.digitalocean.com/images/icons/ddos.9bd745e00c340f315df5e60a2aef6a3ae3b2a4b9c16e583378f013ce39e94aaf.svg)DDoS](https://docs.digitalocean.com/support/ddos/)
- [![](https://docs.digitalocean.com/images/icons/dns.cb34d0653affb99d6826d0a3c70bdb8311ae7f51ca44810ae41cb1deb2e03a71.svg)DNS](https://docs.digitalocean.com/support/dns/)
- [![](https://docs.digitalocean.com/images/icons/droplets.f4877fc574e6b07f8fb9608e252be4160ebecd65569acea11775a046b9370c6f.svg)Droplets](https://docs.digitalocean.com/support/droplets/)
- [![](https://docs.digitalocean.com/images/icons/firewalls.ae799a907969d743602c769c16fd2ad744471b683543c748c3cfb89494091454.svg)Firewalls](https://docs.digitalocean.com/support/firewalls/)
- [![](https://docs.digitalocean.com/images/icons/functions.b0bb037d0e06c09d659cd32aeb2b48c4195d6e824680f25a98d7ed1c24010331.svg)Functions](https://docs.digitalocean.com/support/functions/)
- [![](https://docs.digitalocean.com/images/icons/gradient-ai-platform.d44093369d163f66a792e27c3d48418be24ba1c7d9e216e99032e5cd6c166096.svg)DigitalOcean Gradient™ AI Platform](https://docs.digitalocean.com/support/gradient-ai-platform/)
- [![](https://docs.digitalocean.com/images/icons/ipv6.5328c5b0b5ae17c7784679c40c051945e4799cda74d004c85a41eba70b6a07f9.svg)IPv6](https://docs.digitalocean.com/support/ipv6/)
- [![](https://docs.digitalocean.com/images/icons/kafka.6e5f03a9446ce8ef1cb8ff94d5cfc2174c6a0778b884650e64476af3a9d0888b.svg)Kafka](https://docs.digitalocean.com/support/kafka/)
- [![](https://docs.digitalocean.com/images/icons/kubernetes.5c9f5538fc3c9db4ddd19b3b4c2166c4e06a899c3582345cc892b570bd214072.svg)Kubernetes](https://docs.digitalocean.com/support/kubernetes/)
- [![](https://docs.digitalocean.com/images/icons/load-balancers.1b5f8a9d40bf92d2798a187032a28a29572afdd5e74855e5b1c1d30dfffc07ed.svg)Load Balancers](https://docs.digitalocean.com/support/load-balancers/)
- [![](https://docs.digitalocean.com/images/icons/mongodb.15f32316da2692011abce02f393a1ee6db469250230cf1ea962c181c0e9e7de5.svg)MongoDB](https://docs.digitalocean.com/support/mongodb/)
- [![](https://docs.digitalocean.com/images/icons/monitoring.76945ea4a7d45a01469c36e1133e112e8cf2b800c56b8106f31d27b146221b0f.svg)Monitoring](https://docs.digitalocean.com/support/monitoring/)
- [![](https://docs.digitalocean.com/images/icons/mysql.15f32316da2692011abce02f393a1ee6db469250230cf1ea962c181c0e9e7de5.svg)MySQL](https://docs.digitalocean.com/support/mysql/)
- [![](https://docs.digitalocean.com/images/icons/networking.8ce61209d990cc1c01165492e38bc20ff73c12a59a93ea2fce5f487949e23b78.svg)Networking](https://docs.digitalocean.com/support/networking/)
- [![](https://docs.digitalocean.com/images/icons/opensearch.2629f480d99bedd31ae31e9fd8269c327373bb1a8ecc38a68f458985e2393b42.svg)Opensearch](https://docs.digitalocean.com/support/opensearch/)
- [![](https://docs.digitalocean.com/images/icons/support.91273ef64796cbf92aa09b42996c4fd5bae614b3ce3dd81c685d8da10c28f209.svg)Paperspace](https://docs.digitalocean.com/support/paperspace/)
- [![](https://docs.digitalocean.com/images/icons/postgresql.855c43f1f82e98a24a05998729b39a9937438c7f77af3dc0c22da5a5739f5eb7.svg)PostgreSQL](https://docs.digitalocean.com/support/postgresql/)
- [![](https://docs.digitalocean.com/images/icons/redis.213385ebd06d3cd436657564821380f108a92109b568f05c3313d87fc0bc0c96.svg)Redis](https://docs.digitalocean.com/support/redis/)
- [![](https://docs.digitalocean.com/images/icons/reserved-ips.c9c9b721d99d9592de022671f4dd4b27147dea7162dbfa52ee239edccf9d612f.svg)Reserved IPs](https://docs.digitalocean.com/support/reserved-ips/)
- [![](https://docs.digitalocean.com/images/icons/snapshooter.13e207b5891670f2b29dbf31513a019ebef8731d27c25446bbf7557251aca915.svg)SnapShooter](https://docs.digitalocean.com/support/snapshooter/)
- [![](https://docs.digitalocean.com/images/icons/snapshots.257b4659783b27a6528d9939dcfcb23d26d0ecb4f674e8b728d4bbee764fc3c9.svg)Snapshots](https://docs.digitalocean.com/support/snapshots/)
- [![](https://docs.digitalocean.com/images/icons/spaces.77fdb5bd2197bad96040b9d1e46f6a66a0cb7b3c03213c5f52b42f43e268affa.svg)Spaces](https://docs.digitalocean.com/support/spaces/)
- [![](https://docs.digitalocean.com/images/icons/teams.d6932e5b476fcbbdf1fecec304776ef06c1a04d23174de1c0e6b349d96add59f.svg)Teams](https://docs.digitalocean.com/support/teams/)
- [![](https://docs.digitalocean.com/images/icons/support.91273ef64796cbf92aa09b42996c4fd5bae614b3ce3dd81c685d8da10c28f209.svg)Third-Party Applications](https://docs.digitalocean.com/support/third-party-applications/)
- [![](https://docs.digitalocean.com/images/icons/volumes.9c13d8bb9aee0348ee1af5d72d4c795b4eea86db85fa161806e73d12c0b756d3.svg)Volumes](https://docs.digitalocean.com/support/volumes/)
- [![](https://docs.digitalocean.com/images/icons/vpc.8e35a29c5ce11122208ae3824979d1635c2e67bfb31236328f0665502135db7e.svg)VPC](https://docs.digitalocean.com/support/vpc/)

- [Support Home](https://docs.digitalocean.com/support/)
- Protocol Initiation Issues

[Can't Sign In?](https://www.digitalocean.com/company/contact/support)

# How to Troubleshoot SSH Protocol Issues

Validated on 4 Mar 2024 • Last edited on 17 Jun 2025

SSH is the primary method available for managing DigitalOcean Droplets. Dealing with SSH errors or failures can be frustrating because the errors themselves often prohibit you from accessing your servers.

There are two prerequisites to troubleshooting SSH issues:

1. [**Should I troubleshoot SSH?**](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-protocol-issues/#should-i-ts) Determine whether troubleshooting is the right decision or if migration/redeployment is more appropriate.
2. [**What should I do before troubleshooting SSH?**](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-protocol-issues/#before-ts). Make sure the issue is truly with SSH, then review the information and skills necessary to resolve SSH issues, like having root access to the server and understanding how to access and edit files.

## When to Consider Migration or Redeployment

To resolve your issue quickly, first determine whether troubleshooting the connection is the right solution for your problem or if you should instead focus on [recovering your data for redeployment](https://docs.digitalocean.com/products/droplets/how-to/recovery/recovery-iso/).

Some issues, such as an accidental recursive `rm` or `chmod` command or incorrect network configuration, can lock you out of a Droplet permanently. Other issues may seem like connection problems, but are actually more complex issues with no clear resolution, like corrupted file systems, incorrect file permissions and ownership, and broken system packages and required libraries.

You can typically identify boot errors through the Droplet console startup output. File system issues and startup failures that prevent [a working console login session](https://docs.digitalocean.com/products/droplets/how-to/connect-with-console/) are signs that troubleshooting your network configuration may not be the better option. In situations like this, the best approach is to salvage what you can. In some cases, a good [backup](https://docs.digitalocean.com/products/backups/) or [snapshot](https://docs.digitalocean.com/products/snapshots/) strategy is the fastest way back to your previous working environment.

## What to Do Before Troubleshooting

If you’ve decided that troubleshooting is right for your situation, go through the following steps:

1. **Check the control panel.** Before anything else, make sure there are no [ongoing issues](https://status.digitalocean.com/), like an outage in the region impacting your Droplet.

2. **Check if Droplet is disabled because of abuse.** Droplets are sometimes disabled due to the detection of abusive activity. If your Droplet has been disabled, an email has been sent to the email address linked to your DigitalOcean account with the title `Networking Disabled: <your-droplet-name>`. You can also log in to the [support portal](https://cloudsupport.digitalocean.com/) to see if any support tickets have been created for your resources.

If your Droplet has been disabled due to suspected abuse, [contact our support team](https://www.digitalocean.com/support) for further information.

3. **Recover root access.** If you do not have the current root password, reset it using the [reset root password](https://docs.digitalocean.com/support/how-do-i-reset-my-droplets-root-password/) function in the control panel.

4. **Access the Recovery Console.** If you cannot log in to the Droplet, [the Recovery Console](https://docs.digitalocean.com/products/droplets/how-to/recovery/recovery-console/) is another way to gain access (as long as your Droplet is running and you have a working root password).

5. **Reboot your Droplet.** Many connectivity problems can be resolved after a reboot. If you’re experiencing connectivity issues, try rebooting the Droplet and see if this resolves the issue.

Before rebooting your Droplet, [we highly recommend taking a snapshot of it](https://docs.digitalocean.com/products/snapshots/how-to/snapshot-droplets/). This allows you to [redeploy your Droplet in its current configuration](https://docs.digitalocean.com/products/snapshots/getting-started/quickstart/#create-droplets-and-volumes-from-snapshots) if rebooting the Droplet causes more serious problems.

To reboot your Droplet, log in to it and run the following command:


```
sudo reboot
```

6. **Review file management and permissions.** Some of these solutions may require you to [review or edit files](https://www.digitalocean.com/community/tutorials/basic-linux-navigation-and-file-management) on the system or [manage permissions](https://www.digitalocean.com/community/tutorials/an-introduction-to-linux-permissions).

7. **Check logs.** Once you can get into the Droplet, check the system’s log files for more information to identify the error so you can then look up a solution.

You can learn more about the logs on your server with [this Linux logging tutorial](https://www.digitalocean.com/community/tutorials/how-to-view-and-configure-linux-logs-on-ubuntu-and-centos) and [this journalctl and systemd logging tutorial](https://www.digitalocean.com/community/tutorials/how-to-use-journalctl-to-view-and-manipulate-systemd-logs).

8. **Use verbose SSH output.** The level of detail an SSH client provides about the SSH session is generally quiet by default. It’s helpful to have more information when debugging an issue.

For the OpenSSH client, you can use the `-v` option with multiple `v` entries to increase the verbosity of the output, as in `ssh -v user@203.0.113.0`. While most issues are revealed with a single `v`, some issues may benefit from `-vvv`.

The PuTTY client supports an Event Log accessible from the context icon in the application window bar. There’s also an option for configuring session logging from the settings page when initiating the connection.


After you decide to troubleshoot an SSH issue instead of migrating or redeploying, you can identify and resolve specific SSH errors based on which [phase of a successful SSH connection](https://www.digitalocean.com/community/tutorials/understanding-the-ssh-encryption-and-connection-process) you need to debug.

Once a connection is successfully established, the SSH protocol negotiates an encrypted connection with the client based on establishing trust. Before you can even verify who you are on the system, the system attempts to establish an encryption method with your client. There are a few unique issues that can occur in this scope, and this tutorial covers how to identify them, how to resolve them, and additional resources to prevent them.

## Errors

### Host Key Verification Issues

When you connect to a server through an SSH client, the server attempts to identify itself using a host key. In situations where the host key changes, you may see a warning such as:

```
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
Someone could be eavesdropping on you right now (man-in-the-middle attack)!
It is also possible that a host key has just been changed.
...
```

In PuTTY, you get an equally ominous warning:

```
WARNING - POTENTIAL SECURITY BREACH!

The server's host key does not match the one PuTTY has
cached in the registry. This means that either the
Server administrator has changed the host key, or you
...
```

Common causes for this issue include:

- Rebuilding the Droplet from a snapshot or backup
- Moving a [Reserved IP](https://docs.digitalocean.com/products/networking/reserved-ips/) to another Droplet
- Reinstalling the SSH server through the package manager

To resolve this, you can [clear your host keys](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-protocol-issues/#clearing-out-host-keys-from-known-hosts).

### Connection Closed or Reset By Peer

In some situations, connectivity is established at the socket level but disconnects during the host key verification phase.

OpenSSH clients may show this error:

```
Connection closed by 203.0.113.0 port 22
```

PuTTY may show this error:

```
Server Unexpectedly closed network connection
```

Some common issues that may cause this error include:

- The SSH service has crashed or is experiencing bugs.
- The SSH service cannot initialize a connection due missing server host keys.

In a situation like this, a more thorough review of the protocol output is necessary. In most cases, you need to investigate this from the server through [the Recovery Console](https://docs.digitalocean.com/products/droplets/how-to/recovery/recovery-console/). From there, make sure that the [service is currently running](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-connectivity-issues/#checking-the-ssh-service-status) and [bound to the expected port](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-connectivity-issues/#checking-the-ssh-service-port).

### Unable to Negotiate with Host

When initiating the SSH protocol, a shared secret is generated through a cipher negotiated between the client and the host.

An OpenSSH client may show an error like this:

```
Unable to negotiate with 203.0.113.0: no matching key exchange method found.
Their offer: diffie-hellman-group1-sha1
```

PuTTY may show an error like this:

```
Couldn't agree a client-to-server cipher (available: aes128-ctr, aes192-ctr, aes256-ctr)
```

Some common issues that may cause this error include:

- You have a modern OpenSSH client implementation and an older host that does not support a common cipher with the client.
- You have customized your SSH client cipher list to only allow a selection that the server does not support.

To resolve this issue, you need to [customize the supported ciphers in your SSH client](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-protocol-issues/#customizing-supported-ssh-ciphers).

## Solutions

### Clearing Out Host Keys from Known Hosts

Host keys are typically stored in the `~/.ssh/known_hosts` file on OpenSSH client implementations. PuTTY typically stores these in the Windows Registry (`HKEY_CURRENT_USER\Software\SimonTatham\PuTTY\SshHostKeys`).

In PuTTY, use the window that opens when you connect to select **Yes** to allow the connection and update the registry. Alternatively, you can manually remove the entry.

On an OpenSSH client, you can find the host entry in the `~/.ssh/known_hosts` file and manually remove it. Another option is to use the `ssh-keygen` command:

```shell
ssh-keygen -R 203.0.113.0
```

This attempts to access and clear the matching host entry in the `known_hosts` file:

```
# Host 203.0.113.0 found: line 2
/home/user/.ssh/known_hosts updated.
Original contents retained as /home/user/.ssh/known_hosts.old
```

You can then try to reconnect to your server normally.

### Checking and Regenerating SSH Host Keys

If your SSH host doesn’t have its own private key to generate a shared secret, the connection is aborted. To check that the host has a private key, look in the `/etc/ssh` directory for a group of files named like `sshd_host_*_key` with corresponding `.pub` files.

If the files don’t exist, you need to regenerate them. You can do this using `ssh-keygen` as **root** or with `sudo`:

```shell
ssh-keygen -A
```

The output reports the actions taken, including a list of the keys generated:

```
ssh-keygen: generating new host keys: RSA DSA ECDSA ED25519
```

You can then try to reconnect to your server normally.

### Customizing Supported SSH Ciphers

You can customize the supported SSH ciphers on your client machine when you need support for a deprecated cipher like SHA1. This is not a very common issue. It typically happens when you use a modern SSH client to connect to an old SSH server that hasn’t yet disabled weaker ciphers.

In OpenSSH, you can configure SHA1 using the `KexAlgorithms` option on the command line:

```shell
openssh -oKexAlgorithms=+diffie-hellman-group1-sha1 root@203.0.113.0
```

PuTTY should already include the Diffie-Hellman group 1 option in the **Connection** \> **SSH** \> **Kex** configuration.

## Conclusion

If you need further help, you can [open a support ticket](https://cloudsupport.digitalocean.com/). Make sure to include the following information:

- The username, host, and port you are using to connect.
- The authentication mechanism you expect to use.
- The full output of the errors linked to the stage of error, including verbose output of the SSH client
- All of the information you’ve gathered from troubleshooting so far.
- Anything you were unclear about while referencing this article.

Including all the above diagnostic information and clarifying where you are encountering the issue when trying to connect can help us quickly get up to speed with where your need on the issue is.

## Related Topics

![](https://docs.digitalocean.com/images/icons/support.svg)

How to Troubleshoot SSH Authentication Issues

Problems with SSH authentication includes permission denied with SSH keys and passwords.

![](https://docs.digitalocean.com/images/icons/support.svg)

How to Troubleshoot SSH Connectivity Issues

Problems with SSH connectivity include hostname resolution errors and connections being refused or timing out.

![](https://docs.digitalocean.com/images/icons/support.svg)

How to Troubleshoot SSH Shell Environment Issues

Problems with SSH shell environments include being unable to fork a process, the system reporting it’s not a valid shell, or issues reaching the home directory.

In this article...

- [When to Consider Migration or Redeployment](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-protocol-issues/#when-to-consider-migration-or-redeployment)
- [What to Do Before Troubleshooting](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-protocol-issues/#before-ts)
- [Errors](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-protocol-issues/#errors)
  - [Host Key Verification Issues](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-protocol-issues/#host-key-verification-issues)
  - [Connection Closed or Reset By Peer](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-protocol-issues/#connection-closed-or-reset-by-peer)
  - [Unable to Negotiate with Host](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-protocol-issues/#unable-to-negotiate-with-host)
- [Solutions](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-protocol-issues/#solutions)
  - [Clearing Out Host Keys from Known Hosts](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-protocol-issues/#clearing-out-host-keys-from-known-hosts)
  - [Checking and Regenerating SSH Host Keys](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-protocol-issues/#checking-and-regenerating-ssh-host-keys)
  - [Customizing Supported SSH Ciphers](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-protocol-issues/#customizing-supported-ssh-ciphers)
- [Conclusion](https://docs.digitalocean.com/support/how-to-troubleshoot-ssh-protocol-issues/#conclusion)

##### Company

- [About](https://www.digitalocean.com/about)
- [Careers](https://www.digitalocean.com/careers)
- [Blog](https://www.digitalocean.com/blog)

##### Docs

- [Docs Home](https://docs.digitalocean.com/)
- [API Reference](https://docs.digitalocean.com/reference/api)
- [CLI Reference](https://docs.digitalocean.com/reference/doctl)
- [Release Notes](https://docs.digitalocean.com/release-notes)
- [Trust Platform](https://www.digitalocean.com/trust)

##### Community

- [Tutorials](https://www.digitalocean.com/community/tutorials)
- [Q&A](https://www.digitalocean.com/community/questions)
- [Write for DOnations](https://www.digitalocean.com/community/pages/write-for-digitalocean)
- [Currents Research](https://www.digitalocean.com/currents)
- [Legal](https://www.digitalocean.com/legal)
- [Code of Conduct](https://www.digitalocean.com/community/pages/code-of-conduct)

##### Support

- [Support Center](https://docs.digitalocean.com/support)
- [Report Abuse](https://www.digitalocean.com/company/contact/abuse)

* * *

Cookie Preferences

© 2025 DigitalOcean, LLC. All rights reserved

### We can't find any results for your search.

Try using different keywords or simplifying your search terms.

Loading...

## Product Docs

### We can't find any results for your search.

Try using different keywords or simplifying your search terms.

## Marketplace

## DigitalOcean Blog

## Community

navigategoexit

GenAI Agent - DigitalOcean

![DigitalOcean Docs Agent](https://product-docs.nyc3.cdn.digitaloceanspaces.com/ai-agent-icon.svg)

This site uses cookies and related technologies, as described in our [privacy policy](https://www.digitalocean.com/legal/privacy-policy/), for purposes that may include site operation, analytics, enhanced user experience, or advertising. You may choose to consent to our use of these technologies, or manage your own preferences. Please visit our [cookie policy](https://www.digitalocean.com/legal/cookie-policy) for more information.

Agree & ProceedDecline AllManage Choices