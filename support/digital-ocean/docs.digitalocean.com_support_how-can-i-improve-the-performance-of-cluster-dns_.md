---
url: "https://docs.digitalocean.com/support/how-can-i-improve-the-performance-of-cluster-dns/"
title: "How can I improve the performance of cluster DNS? | DigitalOcean Documentation"
---

- [DigitalOcean \| Docs](https://docs.digitalocean.com/)

- [Platform](https://docs.digitalocean.com/platform/)
- [Products](https://docs.digitalocean.com/products/)
- [Reference](https://docs.digitalocean.com/reference/)
- [Support](https://docs.digitalocean.com/support/)
- [Sign Up](https://cloud.digitalocean.com/registrations/new)

- [Support Home](https://docs.digitalocean.com/support/)
- [![](https://docs.digitalocean.com/images/icons/accounts.7c3a46a4e139957c37b1ba530846464f3b7432b7bc00793db0d8e788940ddf69.svg)Accounts](https://docs.digitalocean.com/support/accounts/)
- [![](https://docs.digitalocean.com/images/icons/api.47c17d0d57a6ef27c2bdc744b3a7b71edc80838dfbe8431e12f5c3e81f371510.svg)API](https://docs.digitalocean.com/support/api/)
- [![](https://docs.digitalocean.com/images/icons/app-platform.965eeb0520b4c178cc9bf64423065e5aa5c2f47ad6102384e37beca3c079f287.svg)App Platform](https://docs.digitalocean.com/support/app-platform/)
- [![](https://docs.digitalocean.com/images/icons/backups.8f2953b640369857d8e09577aab7309b64ba37e4be8cbad0f0514549bf449bd6.svg)Backups](https://docs.digitalocean.com/support/backups/)
- [![](https://docs.digitalocean.com/images/icons/bare-metal-gpus.7498b79d7a8142afb95399794d7f631c490388aa4fb5b30d9021292dca01d125.svg)Bare Metal GPUs](https://docs.digitalocean.com/support/bare-metal-gpus/)
- [![](https://docs.digitalocean.com/images/icons/billing.357b31651da85802e1aa1c9f0b19cda7b26d5c971352f7176d1a130b21e088b7.svg)Billing](https://docs.digitalocean.com/support/billing/)
- [![](https://docs.digitalocean.com/images/icons/cloudways.4200c764fb56e3bab6adc9c1009bfd314c9c555e4583882b57f4a571a854ac89.svg)Cloudways](https://docs.digitalocean.com/support/cloudways/)
- [![](https://docs.digitalocean.com/images/icons/support.91273ef64796cbf92aa09b42996c4fd5bae614b3ce3dd81c685d8da10c28f209.svg)Container Registry](https://docs.digitalocean.com/support/container-registry/)
- [![](https://docs.digitalocean.com/images/icons/ddos.9bd745e00c340f315df5e60a2aef6a3ae3b2a4b9c16e583378f013ce39e94aaf.svg)DDoS](https://docs.digitalocean.com/support/ddos/)
- [![](https://docs.digitalocean.com/images/icons/dns.cb34d0653affb99d6826d0a3c70bdb8311ae7f51ca44810ae41cb1deb2e03a71.svg)DNS](https://docs.digitalocean.com/support/dns/)
- [![](https://docs.digitalocean.com/images/icons/droplets.f4877fc574e6b07f8fb9608e252be4160ebecd65569acea11775a046b9370c6f.svg)Droplets](https://docs.digitalocean.com/support/droplets/)
- [![](https://docs.digitalocean.com/images/icons/firewalls.ae799a907969d743602c769c16fd2ad744471b683543c748c3cfb89494091454.svg)Firewalls](https://docs.digitalocean.com/support/firewalls/)
- [![](https://docs.digitalocean.com/images/icons/functions.b0bb037d0e06c09d659cd32aeb2b48c4195d6e824680f25a98d7ed1c24010331.svg)Functions](https://docs.digitalocean.com/support/functions/)
- [![](https://docs.digitalocean.com/images/icons/gradient-ai-platform.d44093369d163f66a792e27c3d48418be24ba1c7d9e216e99032e5cd6c166096.svg)DigitalOcean Gradient™ AI Platform](https://docs.digitalocean.com/support/gradient-ai-platform/)
- [![](https://docs.digitalocean.com/images/icons/ipv6.5328c5b0b5ae17c7784679c40c051945e4799cda74d004c85a41eba70b6a07f9.svg)IPv6](https://docs.digitalocean.com/support/ipv6/)
- [![](https://docs.digitalocean.com/images/icons/kafka.6e5f03a9446ce8ef1cb8ff94d5cfc2174c6a0778b884650e64476af3a9d0888b.svg)Kafka](https://docs.digitalocean.com/support/kafka/)
- [![](https://docs.digitalocean.com/images/icons/kubernetes.5c9f5538fc3c9db4ddd19b3b4c2166c4e06a899c3582345cc892b570bd214072.svg)Kubernetes](https://docs.digitalocean.com/support/kubernetes/)
- [![](https://docs.digitalocean.com/images/icons/load-balancers.1b5f8a9d40bf92d2798a187032a28a29572afdd5e74855e5b1c1d30dfffc07ed.svg)Load Balancers](https://docs.digitalocean.com/support/load-balancers/)
- [![](https://docs.digitalocean.com/images/icons/mongodb.15f32316da2692011abce02f393a1ee6db469250230cf1ea962c181c0e9e7de5.svg)MongoDB](https://docs.digitalocean.com/support/mongodb/)
- [![](https://docs.digitalocean.com/images/icons/monitoring.76945ea4a7d45a01469c36e1133e112e8cf2b800c56b8106f31d27b146221b0f.svg)Monitoring](https://docs.digitalocean.com/support/monitoring/)
- [![](https://docs.digitalocean.com/images/icons/mysql.15f32316da2692011abce02f393a1ee6db469250230cf1ea962c181c0e9e7de5.svg)MySQL](https://docs.digitalocean.com/support/mysql/)
- [![](https://docs.digitalocean.com/images/icons/networking.8ce61209d990cc1c01165492e38bc20ff73c12a59a93ea2fce5f487949e23b78.svg)Networking](https://docs.digitalocean.com/support/networking/)
- [![](https://docs.digitalocean.com/images/icons/opensearch.2629f480d99bedd31ae31e9fd8269c327373bb1a8ecc38a68f458985e2393b42.svg)Opensearch](https://docs.digitalocean.com/support/opensearch/)
- [![](https://docs.digitalocean.com/images/icons/support.91273ef64796cbf92aa09b42996c4fd5bae614b3ce3dd81c685d8da10c28f209.svg)Paperspace](https://docs.digitalocean.com/support/paperspace/)
- [![](https://docs.digitalocean.com/images/icons/postgresql.855c43f1f82e98a24a05998729b39a9937438c7f77af3dc0c22da5a5739f5eb7.svg)PostgreSQL](https://docs.digitalocean.com/support/postgresql/)
- [![](https://docs.digitalocean.com/images/icons/redis.213385ebd06d3cd436657564821380f108a92109b568f05c3313d87fc0bc0c96.svg)Redis](https://docs.digitalocean.com/support/redis/)
- [![](https://docs.digitalocean.com/images/icons/reserved-ips.c9c9b721d99d9592de022671f4dd4b27147dea7162dbfa52ee239edccf9d612f.svg)Reserved IPs](https://docs.digitalocean.com/support/reserved-ips/)
- [![](https://docs.digitalocean.com/images/icons/snapshooter.13e207b5891670f2b29dbf31513a019ebef8731d27c25446bbf7557251aca915.svg)SnapShooter](https://docs.digitalocean.com/support/snapshooter/)
- [![](https://docs.digitalocean.com/images/icons/snapshots.257b4659783b27a6528d9939dcfcb23d26d0ecb4f674e8b728d4bbee764fc3c9.svg)Snapshots](https://docs.digitalocean.com/support/snapshots/)
- [![](https://docs.digitalocean.com/images/icons/spaces.77fdb5bd2197bad96040b9d1e46f6a66a0cb7b3c03213c5f52b42f43e268affa.svg)Spaces](https://docs.digitalocean.com/support/spaces/)
- [![](https://docs.digitalocean.com/images/icons/teams.d6932e5b476fcbbdf1fecec304776ef06c1a04d23174de1c0e6b349d96add59f.svg)Teams](https://docs.digitalocean.com/support/teams/)
- [![](https://docs.digitalocean.com/images/icons/support.91273ef64796cbf92aa09b42996c4fd5bae614b3ce3dd81c685d8da10c28f209.svg)Third-Party Applications](https://docs.digitalocean.com/support/third-party-applications/)
- [![](https://docs.digitalocean.com/images/icons/volumes.9c13d8bb9aee0348ee1af5d72d4c795b4eea86db85fa161806e73d12c0b756d3.svg)Volumes](https://docs.digitalocean.com/support/volumes/)
- [![](https://docs.digitalocean.com/images/icons/vpc.8e35a29c5ce11122208ae3824979d1635c2e67bfb31236328f0665502135db7e.svg)VPC](https://docs.digitalocean.com/support/vpc/)

- [Support Home](https://docs.digitalocean.com/support/)
- How can I improve the performance of cluster DNS?

[Can't Sign In?](https://www.digitalocean.com/company/contact/support)

# How can I improve the performance of cluster DNS?

Validated on 21 Feb 2024 • Last edited on 17 Apr 2025

Any region where your DOKS cluster is located has multiple DigitalOcean DNS server nodes. These DNS servers are rate limiting where DigitalOcean puts rate limits per server per source IP address.

DOKS uses [CoreDNS](https://coredns.io/) for _in-cluster_ DNS management. Every cluster, by default, has two CoreDNS replicas to serve DNS requests. Pods reach out to the CoreDNS service for DNS queries which are translated to an endpoint. For _public or out-of-cluster_ hostnames, CoreDNS relays requests to the upstream DigitalOcean DNS servers and the upstream DNS traffic is divided among those nodes. Additionally, pods running in the host network use the upstream DigitalOcean DNS servers by default. If your DOKS cluster gets a lot of DNS queries, you may run into issues due to the server quotas and notice UDP packet drop.

[Prometheus metrics](https://coredns.io/plugins/metrics/) can provide insights of your cluster’s DNS traffic. Depending on the DNS profile, you can use the following strategies to tune the DNS performance of your cluster.

## Enable DNS Caching

NodeLocal DNSCache enables you to run a DNS caching agent on every cluster node to cache DNS results. When a pod makes a DNS request, it first reaches out to the DNS caching agent on the same node. Doing so avoids DNAT rules and connection tracking, which reduces the average DNS lookup time and improves the cluster DNS resolution performance. If the record is not present, then the caching agent queries the CoreDNS service. For more information, see [Using NodeLocal DNSCache in Kubernetes Clusters](https://kubernetes.io/docs/tasks/administer-cluster/nodelocaldns/) in the Kubernetes documentation.

To enable NodeLocal DNSCache, create a `nodelocaldns.yaml` manifest and specify your values, as described in the [Configuration section](https://kubernetes.io/docs/tasks/administer-cluster/nodelocaldns/#configuration) of the Kubernetes documentation.

Additionally, you need to customize the DNS settings of your workloads to use the `<node-local-address>` of the NodeLocal DNSCache. This is required because DOKS-specific iptables rules prevent the DNS cache instances from serving requests in the default NodeLocal DNSCache configuration.

Assuming a `<node-local-address>` of 169.254.0.5, a pod’s manifest looks similar to the following:

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: client
spec:
  containers:
    - name: client
      image: my-org/my-image:v1.2.3
  dnsPolicy: None
  dnsConfig:
    nameservers:
      - 169.254.0.5
    searches:
      - kube-system.svc.cluster.local
      - svc.cluster.local
      - cluster.local
    options:
      name: ndots
      value: "5"
```

The `nameservers` value must be set to the `<node-local-address>` configured into NodeLocal DNSCache. Additionally, the `dnsPolicy` value must be set to `none` to prevent merging in the default CoreDNS name server from the Kubernetes environment. Consequently, other default `resolv.conf` settings, such as `searches` and `options` must also be explicitly defined as shown above.

For more information on how to specify the `dnsConfig` field of the pod, see [Pod’s DNS Config](https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/#pod-dns-config) in the Kubernetes documentation.

## Use Non-Shared Machine Type for Cluster

Machines with shared CPU are prone to increased UDP latency. If your cluster has high DNS traffic, you can [add a new node pool](https://docs.digitalocean.com/products/kubernetes/getting-started/quickstart/#edit-nodes-and-node-pools-for-an-existing-cluster) with a dedicated CPU [machine type](https://docs.digitalocean.com/products/kubernetes/concepts/choosing-a-plan/#select-machine-type) to the cluster. Then delete the node pool which has the Basic nodes. All machine types, except the Basic nodes, are [dedicated CPU Droplets](https://docs.digitalocean.com/products/droplets/concepts/choosing-a-plan/#shared-vs-dedicated).

Alternatively, you can select a dedicated CPU machine type when creating a new cluster if you expect the cluster to have high DNS traffic.

## Scale Out DNS Traffic

Scaling our DNS traffic can improve DNS performance. You can manually increase the replica count of the CoreDNS service from the default value. For example, `kubectl scale deployments.apps -n kube-system coredns --replicas=4` increases the number of replicas to 4 from 2. Use `kubectl describe deployment coredns -n=kube-system` to check the increase in the number of replicas.

Alternatively, you can autoscale the CoreDNS service as described in the [Enable DNS horizontal autoscaling](https://kubernetes.io/docs/tasks/administer-cluster/dns-horizontal-autoscaling/#enablng-dns-horizontal-autoscaling) section of the Kubernetes documentation.

## Reduce DNS Traffic

If possible, reduce the DNS load your client applications send to the cluster.

## Related Topics

![](https://docs.digitalocean.com/images/icons/support.svg)

Why can't my VPC-native pods connect to my Droplets?

For Droplets created before 2 October 2024, you must manually add VPC peering routes to interconnect with VPC-native DOKS clusters

![](https://docs.digitalocean.com/images/icons/support.svg)

How to Troubleshoot Load Balancer Health Check Issues

Health checks often fail due to firewalls or misconfigured backend server software.

![](https://docs.digitalocean.com/images/icons/support.svg)

How do I enable PROXY protocol when my load balancer sends requests to the NGINX Ingress Controller?

Edit the ConfigMap which nginx uses to enable PROXY protocol.

In this article...

- [Enable DNS Caching](https://docs.digitalocean.com/support/how-can-i-improve-the-performance-of-cluster-dns/#enable-dns-caching)
- [Use Non-Shared Machine Type for Cluster](https://docs.digitalocean.com/support/how-can-i-improve-the-performance-of-cluster-dns/#use-non-shared-machine-type-for-cluster)
- [Scale Out DNS Traffic](https://docs.digitalocean.com/support/how-can-i-improve-the-performance-of-cluster-dns/#scale-out-dns-traffic)
- [Reduce DNS Traffic](https://docs.digitalocean.com/support/how-can-i-improve-the-performance-of-cluster-dns/#reduce-dns-traffic)

##### Company

- [About](https://www.digitalocean.com/about)
- [Careers](https://www.digitalocean.com/careers)
- [Blog](https://www.digitalocean.com/blog)

##### Docs

- [Docs Home](https://docs.digitalocean.com/)
- [API Reference](https://docs.digitalocean.com/reference/api)
- [CLI Reference](https://docs.digitalocean.com/reference/doctl)
- [Release Notes](https://docs.digitalocean.com/release-notes)
- [Trust Platform](https://www.digitalocean.com/trust)

##### Community

- [Tutorials](https://www.digitalocean.com/community/tutorials)
- [Q&A](https://www.digitalocean.com/community/questions)
- [Write for DOnations](https://www.digitalocean.com/community/pages/write-for-digitalocean)
- [Currents Research](https://www.digitalocean.com/currents)
- [Legal](https://www.digitalocean.com/legal)
- [Code of Conduct](https://www.digitalocean.com/community/pages/code-of-conduct)

##### Support

- [Support Center](https://docs.digitalocean.com/support)
- [Report Abuse](https://www.digitalocean.com/company/contact/abuse)

* * *

Cookie Preferences

© 2025 DigitalOcean, LLC. All rights reserved

### We can't find any results for your search.

Try using different keywords or simplifying your search terms.

Loading...

## Product Docs

### We can't find any results for your search.

Try using different keywords or simplifying your search terms.

## Marketplace

## DigitalOcean Blog

## Community

navigategoexit

GenAI Agent - DigitalOcean

![DigitalOcean Docs Agent](https://product-docs.nyc3.cdn.digitaloceanspaces.com/ai-agent-icon.svg)

This site uses cookies and related technologies, as described in our [privacy policy](https://www.digitalocean.com/legal/privacy-policy/), for purposes that may include site operation, analytics, enhanced user experience, or advertising. You may choose to consent to our use of these technologies, or manage your own preferences. Please visit our [cookie policy](https://www.digitalocean.com/legal/cookie-policy) for more information.

Agree & ProceedDecline AllManage Choices