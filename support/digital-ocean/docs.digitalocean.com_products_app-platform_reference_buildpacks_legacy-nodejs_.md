---
url: "https://docs.digitalocean.com/products/app-platform/reference/buildpacks/legacy-nodejs/"
title: "Legacy Node.js Buildpack on App Platform | DigitalOcean Documentation"
---

- [DigitalOcean \| Docs](https://docs.digitalocean.com/)

- [Platform](https://docs.digitalocean.com/platform/)
- [Products](https://docs.digitalocean.com/products/)
- [Reference](https://docs.digitalocean.com/reference/)
- [Support](https://docs.digitalocean.com/support/)
- [Sign Up](https://cloud.digitalocean.com/registrations/new)

- [![](https://docs.digitalocean.com/images/icons/app-platform.965eeb0520b4c178cc9bf64423065e5aa5c2f47ad6102384e37beca3c079f287.svg)App Platform](https://docs.digitalocean.com/products/app-platform/)
- [Getting Started](https://docs.digitalocean.com/products/app-platform/getting-started/)
  - [Quickstart](https://docs.digitalocean.com/products/app-platform/getting-started/quickstart/)
  - [Sample Apps](https://docs.digitalocean.com/products/app-platform/getting-started/sample-apps/)
  - [Sample Functions](https://docs.digitalocean.com/products/functions/getting-started/sample-functions/)
  - [Deploy Sample Apps](https://docs.digitalocean.com/products/app-platform/getting-started/deploy-sample-apps/)
  - [Deploy an RSS Reader](https://docs.digitalocean.com/products/app-platform/getting-started/deploy-rss-reader/)
  - [Deploy Etherpad](https://docs.digitalocean.com/products/app-platform/getting-started/deploy-etherpad/)
- [How-Tos](https://docs.digitalocean.com/products/app-platform/how-to/)
  - [Create Apps](https://docs.digitalocean.com/products/app-platform/how-to/create-apps/)
  - [Deploy from Container Images](https://docs.digitalocean.com/products/app-platform/how-to/deploy-from-container-images/)
  - [Deploy From Monorepos](https://docs.digitalocean.com/products/app-platform/how-to/deploy-from-monorepo/)
  - [Deploy Using GitHub Actions](https://docs.digitalocean.com/products/app-platform/how-to/deploy-from-github-actions/)
  - [Scale Apps](https://docs.digitalocean.com/products/app-platform/how-to/scale-app/)
  - [Manage Components](https://docs.digitalocean.com/products/app-platform/how-to/manage-components/)
  - [Manage Data Storage](https://docs.digitalocean.com/products/app-platform/how-to/manage-data-storage/)
  - [Manage App Settings](https://docs.digitalocean.com/products/app-platform/how-to/manage-settings/)
  - [Manage Networking](https://docs.digitalocean.com/products/app-platform/how-to/manage-networking/)
  - [Manage Observability](https://docs.digitalocean.com/products/app-platform/how-to/manage-observability/)
  - [Manage Deployments](https://docs.digitalocean.com/products/app-platform/how-to/manage-deployments/)
  - [Access Console](https://docs.digitalocean.com/products/app-platform/how-to/console/)
  - [Restart or Rebuild App](https://docs.digitalocean.com/products/app-platform/how-to/restart-rebuild-app/)
  - [Update App Spec](https://docs.digitalocean.com/products/app-platform/how-to/update-app-spec/)
  - [Manage Source Repository](https://docs.digitalocean.com/products/app-platform/how-to/manage-source-repo/)
  - [Add "Deploy to DigitalOcean" Button](https://docs.digitalocean.com/products/app-platform/how-to/add-deploy-do-button/)
  - [Build Locally](https://docs.digitalocean.com/products/app-platform/how-to/build-locally/)
  - [Use MCP Server](https://docs.digitalocean.com/products/app-platform/how-to/use-mcp/)
  - [Destroy Apps](https://docs.digitalocean.com/products/app-platform/how-to/destroy-app/)
- [Reference](https://docs.digitalocean.com/products/app-platform/reference/)
  - [API Reference](https://docs.digitalocean.com/reference/api/digitalocean/#tag/Apps)
  - [CLI Reference](https://docs.digitalocean.com/reference/doctl/reference/apps/)
  - [Builds with Buildpacks](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/)
    - [Aptfile](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/aptfile/)
    - [Go](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/go/)
    - [Hugo](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/hugo/)
    - [Legacy Node.js (Deprecated)](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/legacy-nodejs/)
    - [Node.js](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/nodejs/)
    - [PHP](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/php/)
    - [Python](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/python/)
    - [Ruby](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/ruby/)
  - [Builds with Dockerfiles](https://docs.digitalocean.com/products/app-platform/reference/dockerfile/)
  - [App Spec Reference](https://docs.digitalocean.com/products/app-platform/reference/app-spec/)
  - [Dev Config Reference](https://docs.digitalocean.com/products/app-platform/reference/dev-config/)
  - [Error Code Reference](https://docs.digitalocean.com/products/app-platform/reference/error-codes/)
- [Concepts](https://docs.digitalocean.com/products/app-platform/concepts/)
  - [Choosing a Plan](https://docs.digitalocean.com/products/app-platform/concepts/choosing-a-plan/)
  - [Platform Upgrade Policy](https://docs.digitalocean.com/products/app-platform/concepts/platform-upgrade-policy/)
  - [Glossary](https://docs.digitalocean.com/glossary/app-platform/)
- [Details](https://docs.digitalocean.com/products/app-platform/details/)
  - [Introduction FAQ](https://docs.digitalocean.com/products/app-platform/details/intro-faq/)
  - [Features](https://docs.digitalocean.com/products/app-platform/details/features/)
  - [Pricing](https://docs.digitalocean.com/products/app-platform/details/pricing/)
  - [Availability](https://docs.digitalocean.com/products/app-platform/details/availability/)
  - [Limits](https://docs.digitalocean.com/products/app-platform/details/limits/)
  - [Maintenance](https://docs.digitalocean.com/products/app-platform/details/maintenance/)
  - [Service-Level Agreement](https://www.digitalocean.com/sla/app-platform)
- [Support](https://docs.digitalocean.com/products/app-platform/support/)

- [Reference](https://docs.digitalocean.com/products/app-platform/reference/)
- [Builds with Buildpacks](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/)
- Legacy Node.js (Deprecated)

[Give Feedback](https://ideas.digitalocean.com/documentation)

# Legacy Node.js Buildpack on App Platform

Validated on 15 Oct 2024 • Last edited on 17 Jun 2025

App Platform is a Platform-as-a-Service (PaaS) offering that allows developers to publish code directly to DigitalOcean servers without worrying about the underlying infrastructure.

## How App Platform Builds Images

Warning

This buildpack is deprecated. Use the [new Heroku Node.js Buildpack](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/nodejs/), instead.

All new apps use the new Node.js buildpack by default. To upgrade existing apps crated before 17 September 2024 to the new Node.js buildpack, see [How to Upgrade Your Node.js Buildpack in App Platform](https://docs.digitalocean.com/products/app-platform/how-to/migrate-nodejs-buildpack/).

App Platform supports two ways to build an image for your app: [Cloud Native Buildpacks](https://buildpacks.io/) and [Dockerfiles](https://docs.docker.com/engine/reference/builder/).

When you give App Platform access to your code, it defaults to using a Dockerfile if one is present in the root of the directory or specified in the app spec. Otherwise, App Platform checks your code to determine what language or framework it uses. If it supports the language or framework, it chooses an appropriate resource type and uses the proper buildpack to build the app and deploy a container.

[heroku-buildpack-nodejs](https://github.com/heroku/heroku-buildpack-nodejs#readme) is utilized as the buildpack for detecting and building your Node.js applications and applications using Node.js frameworks such as Express.js, Next.js, and Nuxt.js.

## Node.js Applications using Buildpacks

App Platform looks for any of the following files to detect a Node.js application:

- `package.json`
- `package-lock.json`
- `yarn.lock`
- `pnpm-lock.yaml`

The order of preference is `yarn.lock`, `pnpm-lock.yaml` and `package-lock.json`.
If all three files are present, Yarn is preferred.
If only `pnpm-lock.yaml` and `package-lock.json` exist, Pnpm is preferred.

### Current Buildpack Version and Supported Runtimes

#### Default Stack

App Platform uses version `0.4.0` of the Node.js Cloud Native Buildpack by default. If no version is specified in your app, for Node.js v1 App Platform defaults to using version `20.x` and for Node.js v0 App Platform defaults to using version `16.x`.

The buildpack supports the following Node.js runtime versions:

- Ubuntu-22
  - 6.x - 21.x
- Ubuntu-18
  - 6.x - 17.x

### Specifying Versions

Specify your desired Node version in the `engines` section of `package.json`.

`package.json`

```json
{
  "engines": {
    "node": "16.x"
  }
}
```

You can customize the npm version used by specifying the version in the `engines` section of your `package.json`:

`package.json`

```json
{
  "engines": {
    "npm": "~1.0.20"
  }
}
```

You can customize the Yarn version used by specifying the version in the `engines` section of your `package.json`:

`package.json`

```json
{
  "engines": {
    "yarn": "^0.14.0"
  }
}
```

Starting from Yarn v3, the default behaviour is changed to Plug’n’Play i.e.
on yarn install, a single Node.js loader file is generated in place of typical node\_modules.

Our nodejs-buildpack needs node\_modules to be present in project.
In order to fix this, the user needs to add a .yarnrc.yml file with config - nodeLinker: node-modules.
This tells yarn to generate node\_modules.

Note [Long Term Support (LTS)](https://github.com/nodejs/Release) versions of Node.js are not supported.

You can customize the Pnpm version used by specifying the version in the `engines` section of your `package.json`:

`package.json`

```json
{
  "engines": {
    "pnpm": "8.14.1"
  }
}
```

### Specifying devDependencies

App Platform installs `devDependencies` and doesn’t set `NODE_ENV` during the build process by default. If your build command requires `devDependencies` but you want to set `NODE_ENV` to `production`, configure the following custom script. This script installs `devDependencies` even if `NODE_ENV` is set to `production`.

#### Yarn

`package.json`

```json
"scripts": {
    "build:digitalocean": "yarn install --production=false && yarn run build && rm -rf node_modules && yarn install --production --frozen-lockfile",
    ...
  }
```

App Platform Build Command

```bash
yarn build:digitalocean
```

#### Pnpm

`package.json`

```json
"scripts": {
    "build:digitalocean": "pnpm install --production=false && pnpm run build && rm -rf node_modules && pnpm install --production --frozen-lockfile",
    ...
  }
```

App Platform Build Command

```bash
pnpm run build:digitalocean
```

#### npm

`package.json`

```json
  "scripts": {
    "build:digitalocean": "npm install --production=false && npm run build && npm ci",
    ...
  }
```

Note

If you are using an older Node.js version prior to 7.7.x, use this build command instead.

`package.json`

```json
  "scripts": {
    "build:digitalocean": "npm install --include=dev && npm run build && npm ci",
    ...
  }
```

App Platform Build Command

```bash
npm run build:digitalocean
```

### Caching

The buildpack automatically caches and re-uses the `node_modules` directory between builds. After the package manager’s install command is run (`yarn install` or `npm install`), the `node_modules` directory is stored in the build cache along with snapshot of the package manager’s lockfile. In subsequent builds, the cached `node_modules` directory will be restored only if the lockfile’s contents are identical to cached version. Otherwise, the cache will be discarded.

### Clearing the Cache

If your app is failing to build and you suspect that the issue is related to `node_modules` caching, you can force clear the cache and start a new build. To do this in the control panel, navigate to your app, click the **Actions** menu, and then select **Force Build and Deploy**.

![Force Build and Deploy screen with Clear Build Cache checked](https://docs.digitalocean.com/screenshots/app-platform/app-force-build-deploy.ea850a5eedb3f0eb34516acbab175572522ccee86f310e9ae18d75b096b94c1d.png)

In the **Force Build and Deploy** window, select the **Clear Build Cache** option, and then click the “Deploy” button. This clears the build cache and starts a new deployment.

Here’s an example with Node and Express that uses the PORT variable or `3000` for developing locally.

```jsx
const express = require('express');
const app = express();

// get our port
const port = process.env.PORT || 3000;

// application code goes here

// have node listen on our port
app.listen(port, () => console.log(`App listening on port ${port}!`));
```

In this article...

- [How App Platform Builds Images](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/legacy-nodejs/#how-app-platform-builds-images)
- [Node.js Applications using Buildpacks](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/legacy-nodejs/#nodejs-applications-using-buildpacks)
  - [Current Buildpack Version and Supported Runtimes](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/legacy-nodejs/#current-buildpack-version-and-supported-runtimes)
    - [Default Stack](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/legacy-nodejs/#default-stack)
  - [Specifying Versions](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/legacy-nodejs/#specifying-versions)
  - [Specifying devDependencies](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/legacy-nodejs/#specifying-devdependencies)
    - [Yarn](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/legacy-nodejs/#yarn)
    - [Pnpm](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/legacy-nodejs/#pnpm)
    - [npm](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/legacy-nodejs/#npm)
  - [Caching](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/legacy-nodejs/#caching)
  - [Clearing the Cache](https://docs.digitalocean.com/products/app-platform/reference/buildpacks/legacy-nodejs/#clearing-the-cache)

##### Company

- [About](https://www.digitalocean.com/about)
- [Careers](https://www.digitalocean.com/careers)
- [Blog](https://www.digitalocean.com/blog)

##### Docs

- [Docs Home](https://docs.digitalocean.com/)
- [API Reference](https://docs.digitalocean.com/reference/api)
- [CLI Reference](https://docs.digitalocean.com/reference/doctl)
- [Release Notes](https://docs.digitalocean.com/release-notes)
- [Trust Platform](https://www.digitalocean.com/trust)

##### Community

- [Tutorials](https://www.digitalocean.com/community/tutorials)
- [Q&A](https://www.digitalocean.com/community/questions)
- [Write for DOnations](https://www.digitalocean.com/community/pages/write-for-digitalocean)
- [Currents Research](https://www.digitalocean.com/currents)
- [Legal](https://www.digitalocean.com/legal)
- [Code of Conduct](https://www.digitalocean.com/community/pages/code-of-conduct)

##### Support

- [Support Center](https://docs.digitalocean.com/support)
- [Report Abuse](https://www.digitalocean.com/company/contact/abuse)

* * *

Cookie Preferences

© 2025 DigitalOcean, LLC. All rights reserved

### We can't find any results for your search.

Try using different keywords or simplifying your search terms.

Loading...

## Product Docs

### We can't find any results for your search.

Try using different keywords or simplifying your search terms.

## Marketplace

## DigitalOcean Blog

## Community

navigategoexit

This site uses cookies and related technologies, as described in our [privacy policy](https://www.digitalocean.com/legal/privacy-policy/), for purposes that may include site operation, analytics, enhanced user experience, or advertising. You may choose to consent to our use of these technologies, or manage your own preferences. Please visit our [cookie policy](https://www.digitalocean.com/legal/cookie-policy) for more information.

Agree & ProceedDecline AllManage Choices

GenAI Agent - DigitalOcean

![DigitalOcean Docs Agent](https://product-docs.nyc3.cdn.digitaloceanspaces.com/ai-agent-icon.svg)