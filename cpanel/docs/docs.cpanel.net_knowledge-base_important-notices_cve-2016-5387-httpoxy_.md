---
url: "https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/"
title: "CVE-2016-5387 HTTPOXY | cPanel & WHM Documentation"
---

[Skip to main content](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/#main-content)

[![cPanel logo](https://docs.cpanel.net/img/docs-logo.min.svg)](https://docs.cpanel.net/)

- [Release Notes](https://docs.cpanel.net/release-notes/)
- [Change Logs](https://docs.cpanel.net/changelogs/)
- [Forums](https://forums.cpanel.net/)
- [Support Ticket](https://tickets.cpanel.net/review/login.cgi)
- [Try Demo](https://cpanel.net/products/trial/)

AllcPanelWHMEA4Knowledge BaseManage2WebmailAPI

AllcPanelWHMEA4Knowledge BaseManage2WebmailAPI

1. [cPanel & WHM Documentation](https://docs.cpanel.net/)
2. [cPanel Knowledge Base](https://docs.cpanel.net/knowledge-base/)
3. [Important Notices](https://docs.cpanel.net/knowledge-base/important-notices/)
4. CVE-2016-5387 HTTPOXY


[whmadvanced](https://docs.cpanel.net/tags/whmadvanced/) [security](https://docs.cpanel.net/tags/security/)

#### Table of Contents

[Background Information](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/#background-information)

* * *

[Impact](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/#impact)

* * *

[Releases](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/#releases)

* * *

[How to determine if your server is up-to-date](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/#how-to-determine-if-your-server-is-up-to-date)

* * *

[What to do if you are not up-to-date](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/#what-to-do-if-you-are-not-up-to-date)

* * *

[Manual mitigation via mod\_headers](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/#manual-mitigation-via-modheaders)

* * *

[Manual mitigation via ModSecurity](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/#manual-mitigation-via-modsecurity)

* * *

Was this helpful?

[**Table of Contents**](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/#table-of-contents-toggle)

[Background Information](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/#background-information)

* * *

[Impact](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/#impact)

* * *

[Releases](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/#releases)

* * *

[How to determine if your server is up-to-date](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/#how-to-determine-if-your-server-is-up-to-date)

* * *

[What to do if you are not up-to-date](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/#what-to-do-if-you-are-not-up-to-date)

* * *

[Manual mitigation via mod\_headers](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/#manual-mitigation-via-modheaders)

* * *

[Manual mitigation via ModSecurity](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-5387-httpoxy/#manual-mitigation-via-modsecurity)

* * *

## CVE-2016-5387 HTTPOXY

Last modified: _2022 December 2_

* * *

## Background Information

On Monday, July 18, 2016, Apache disclosed a vulnerability that affects application code which runs in CGI, or CGI-like environments. This includes the `mod_php` and `php-fpm` Apache modules, among others. For more information on this vulnerability, read the [HTTPOXY website.](https://httpoxy.org/)

## Impact

Environments vulnerable to this exploit include any that run PHP or CGI, and use the `HTTP_PROXY` variable to configure outgoing proxies.

## Releases

Apache released a patch for all versions of Apache 2.2 and Apache 2.4.

cPanel & WHM released patched Apache binaries for EasyApache 3 in the 3.34.2 release on July 20, 2016, and for EasyApache 4 in the July 21, 2016, release.

## How to determine if your server is up-to-date

In EasyApache 3, either navigate to the _EasyApache_ 3 interface ( _WHM » Home » Software » EasyApache 3_) or run the `/usr/local/cpanel/scripts/easyapache` script and ensure that your EasyApache 3 version is `3.34.2` or higher.

In EasyApache 4, the updated RPMs provided will contain a changelog entry with a CVE number. To view this changelog entry, run the following command:

```bash
rpm -q --changelog ea-apache24 | grep CVE-2016-5387
```

The output will resemble the following:

```bash
- Apply recommendations in asf-httpoxy-repsponse.txt for CVE-2016-5387
```

## What to do if you are not up-to-date

We released patched Apache binaries for EasyApache 3 on July 20, 2016, and for EasyApache 4 on July 21, 2016. To update your server, perform one of the following steps:

- Run an EasyApache 3 build to update your system to version 3.34.2.
- In EasyApache 4, run the `yum update` command and ensure that you get an updated package of at least `ea-apache24-2.4.23-2`

### Manual mitigation via mod\_headers

#### EasyApache 3

To mitigate this issue before cPanel releases the update, you can update the `mod_headers` Apache module to remove the `"Proxy:"` header from all incoming requests. Add the following lines to your `/usr/local/apache/conf/httpd.conf` file:

|     |     |
| --- | --- |
| ```<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>``` | ```go<br><IfModule headers_module><br>    #<br>    # Avoid passing HTTP_PROXY environment to CGI's on this or any proxied<br>    # backend servers which have lingering "httpoxy" defects.<br>    # 'Proxy' request header is undefined by the IETF, not listed by IANA<br>    #<br>    RequestHeader unset Proxy early<br></IfModule><br>``` |

#### EasyApache 4

To mitigate this issue before cPanel releases the update, you can update the `mod_headers` Apache module to remove the `"Proxy:"` header from all incoming requests. Add the following lines to your `/etc/apache2/conf/httpd.conf` file:

|     |     |
| --- | --- |
| ```<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>``` | ```go<br><IfModule headers_module><br>    #<br>    # Avoid passing HTTP_PROXY environment to CGI's on this or any proxied<br>    # backend servers which have lingering "httpoxy" defects.<br>    # 'Proxy' request header is undefined by the IETF, not listed by IANA<br>    #<br>    RequestHeader unset Proxy early<br></IfModule><br>``` |

## Manual mitigation via ModSecurity

If you use ModSecurity®, you can add a custom ModSecurity rule to deny traffic with a Proxy header. To add this rule, perform the following steps:

01. Navigate to WHM’s [_ModSecurity® Configuration_](https://docs.cpanel.net/whm/security-center/modsecurity-configuration/) interface ( _WHM » Home » Security Center » ModSecurity® Configuration_).
02. Select _Process the Rules_ in the _Rules Engine_ section.
03. Click Save.
04. Navigate to WHM’s [_Modsecurity® Tools_](https://docs.cpanel.net/whm/security-center/modsecurity-tools/) interface ( _WHM » Home » Security Center » ModSecurity® Tools_).
05. Click _Rules List_. A new interface will appear.
06. Click _Add Rule_. A new interface will appear.
07. Enter the following rule in the _Rule Text_ text box:



    ```bash
    SecRule &REQUEST_HEADERS:Proxy "@gt 0" "id:1000005,log,deny,msg:'httpoxy denied'"
    ```

08. To enable the rule when you deploy the configuration, select the _Enable Rule_ checkbox.
09. To deploy the rule and restart Apache immediately, select the _Deploy and Restart Apache_ checkbox.
10. Click _Save_.

Warning:

This exploit has the potential to affect many different applications. If you experience trouble with other applications after you update your system, you **must** contact the application developer for further assistance.

If you still experience issues or need additional help, contact [cPanel Support](https://tickets.cpanel.net/review/login.cgi)

#### Additional Documentation

* * *

- [Apache mod\_userdir Tweak](https://docs.cpanel.net/whm/security-center/apache-mod_userdir-tweak/)
- [Backup Retention Behavior](https://docs.cpanel.net/knowledge-base/backup/backup-retention-behavior/)
- [Manage root's SSH Keys](https://docs.cpanel.net/whm/security-center/manage-root-ssh-keys/)
- [The check\_security\_advice\_changes Script](https://docs.cpanel.net/whm/scripts/the-check_security_advice_changes-script/)
- [The securetmp Script](https://docs.cpanel.net/whm/scripts/the-securetmp-script/)
- [The cPanel Glossary](https://docs.cpanel.net/knowledge-base/cpanel-product/cpanel-glossary/)

[![](https://docs.cpanel.net/img/cpanel-logo.min.svg)](https://cpanel.com/ "WebPros International, LLC")

© 2025 All Rights Reserved / [Legal Notices](https://cpanel.com/legal-notices.html "Legal Notices") / [Privacy Policy](https://cpanel.com/privacy-policy.html "Privacy Policy") / [Transparency Report](https://cpanel.com/transparency-report.html "Transparency Report")

cPanel, WebHost Manager, and WHM are registered trademarks of WebPros International, LLC for providing its computer software that facilitates the management and configuration of internet web servers.

×