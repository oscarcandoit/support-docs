---
url: "https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/"
title: "CVE-2016-6662 MySQL | cPanel & WHM Documentation"
---

[Skip to main content](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#main-content)

[![cPanel logo](https://docs.cpanel.net/img/docs-logo.min.svg)](https://docs.cpanel.net/)

- [Release Notes](https://docs.cpanel.net/release-notes/)
- [Change Logs](https://docs.cpanel.net/changelogs/)
- [Forums](https://forums.cpanel.net/)
- [Support Ticket](https://tickets.cpanel.net/review/login.cgi)
- [Try Demo](https://cpanel.net/products/trial/)

AllcPanelWHMEA4Knowledge BaseManage2WebmailAPI

AllcPanelWHMEA4Knowledge BaseManage2WebmailAPI

1. [cPanel & WHM Documentation](https://docs.cpanel.net/)
2. [cPanel Knowledge Base](https://docs.cpanel.net/knowledge-base/)
3. [Important Notices](https://docs.cpanel.net/knowledge-base/important-notices/)
4. CVE-2016-6662 MySQL


[whmadvanced](https://docs.cpanel.net/tags/whmadvanced/) [mysql](https://docs.cpanel.net/tags/mysql/)

#### Table of Contents

[Background Information](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#background-information)

* * *

[Impact](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#impact)

* * *

[How to determine if your server is affected.](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#how-to-determine-if-your-server-is-affected)

* * *

[Determine if you are running MySQL or MariaDB](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#determine-if-you-are-running-mysql-or-mariadb)

* * *

[Resolution](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#resolution)

* * *

[MySQL](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#mysql)

* * *

[MariaDB](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#mariadb)

* * *

[Mitigation](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#mitigation)

* * *

Was this helpful?

[**Table of Contents**](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#table-of-contents-toggle)

[Background Information](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#background-information)

* * *

[Impact](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#impact)

* * *

[How to determine if your server is affected.](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#how-to-determine-if-your-server-is-affected)

* * *

[Determine if you are running MySQL or MariaDB](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#determine-if-you-are-running-mysql-or-mariadb)

* * *

[Resolution](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#resolution)

* * *

[MySQL](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#mysql)

* * *

[MariaDB](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#mariadb)

* * *

[Mitigation](https://docs.cpanel.net/knowledge-base/important-notices/cve-2016-6662-mysql/#mitigation)

* * *

## CVE-2016-6662 MySQL

Last modified: _2024 February 22_

* * *

## Background Information

On 12 September, 2016, an independent researcher revealed multiple MySQL® vulnerabilities. This advisory focuses on a vulnerability with a CVEID of CVE-2016-6662 which can allow attackers to (remotely) inject malicious settings into MySQL configuration files (`my.cnf`) under certain configurations, leading to critical consequences.

More information on MySQL can be found on the following websites:

- [MySQL Products](http://www.mysql.com/products/)
- [Why MySQL](http://www.mysql.com/why-mysql/)
- [MySQL System Properties](http://db-engines.com/en/system/MySQL)

MySQL derivatives are also affected, including:

- [MariaDB](https://mariadb.org/)
- [PerconaDB](https://www.percona.com/software/mysql-database/percona-server)

## Impact

The vulnerability affects all MySQL servers in the default configuration in all version branches (5.7, 5.6, and 5.5) including the latest versions, and can be exploited by both local and remote attackers. Both the authenticated access to MySQL databases (via network connection or web interfaces such as phpMyAdmin) and SQL Injection could be used as exploitation vectors if a MySQL user has the `SUPER` privilege granted. Additionally, MySQL users with both `SELECT` and `FILE` privileges granted are also affected.

MySQL users created in cPanel are not granted the `SUPER` or `FILE` privileges, however they can be granted these elevated privileges from the `root` MySQL user manually.

A successful exploitation could allow attackers to execute arbitrary code with `root` privileges which would then allow them to fully compromise the server on which an affected version of MySQL or MariaDB is running.

## How to determine if your server is affected.

### Determine if you are running MySQL or MariaDB

You can determine if MySQL is installed by running the following command as `root`:

```bash
yum list installed | grep MySQL | grep -server
MySQL56-server.x86_64                             5.6.31-2.cp1156      installed
```

If the above command does not return any output, verify you are running MariaDB by running the following command as `root`:

```bash
yum list installed | grep MariaDB | grep -server
MariaDB-server.x86_64                           10.0.27-1.el7.centos   @MariaDB100
```

#### MySQL

WebPros International, LLC is currently working on new versions with updated MySQL RPMs. We will update this section once new versions are available.

#### MariaDB

MariaDB has fixes in place for versions greater than 10.0.27 and 10.1.17. Run the following command as `root` to check the MariaDB version:

```bash
rpm -q MariaDB-server
MariaDB-server-10.0.26-1.el7.centos.x86_64
```

## Resolution

### MySQL

The following table lists the MySQL versions with updated RPMs and their corresponding cPanel & WHM versions:

| MySQL version | cPanel & WHM version | Documentation |
| --- | --- | --- |
| 5.6.32 | 58.0.30 | [Changes in MySQL 5.6.33 (2016-09-06, General Availability](https://dev.mysql.com/doc/relnotes/mysql/5.6/en/news-5-6-33.html) |
| 5.5.52 | 58.0.30 | [MySQL Community Server 5.5.52](https://forums.mysql.com/read.php?3,650144) |

### MariaDB

Versions 10.0.27 and greater are protected for 10.0.x versions of MariaDB, while versions 10.1.17 are protected for 10.1.x versions of MariaDB. If you are running an older version of MariaDB, you can upgrade with the following command:

```bash
# yum update MariaDB-server MariaDB-client MariaDB-common MariaDB-devel MariaDB-shared
```

## Mitigation

Warning:

- Manual modifications to the MySQL configuration always carries risk; a qualified systems administrator is recommended.
- We **strongly** recommend that you backup your databases before performing any of the steps below.

In most situations, these mitigations are not necessary as unprivileged MySQL users created in cPanel & WHM do not have the `SUPER` or `FILE` grants.

You can check if you have MySQL accounts, other than `root`, with these privileges granted manually by running the following commands as `root`:

```bash
mysql mysql -e 'select User,Host from user where User != "root" and ( File_priv = "Y" or Super_priv = "Y" );'
```

If waiting for new cPanel versions with updated MySQL RPMs or upgrading to MariaDB is not possible, consider mitigating this issue by running the following commands as `root`:

```bash
chown root:root /etc/my.cnf
chmod 0644 /etc/my.cnf
```

This will ensure `/etc/my.cnf` is not writable by the MySQL user.

Additionally, you can touch empty root-owned files at `/var/lib/mysql/my.cnf` and `/var/lib/mysql/.my.cnf` to prevent MySQL users with `SUPER` or `FILE` privileges from potentially writing to other configuration paths that may be used on certain OS and MySQL version combinations. This may cause warnings to be logged when restarting MySQL.

```bash
touch /var/lib/mysql/my.cnf /var/lib/mysql/.my.cnf
```

#### Additional Documentation

* * *

- [Additional MySQL Access Hosts](https://docs.cpanel.net/whm/sql-services/additional-mysql-access-hosts/)
- [The auto-adjust-mysql-limits Script](https://docs.cpanel.net/whm/scripts/the-auto-adjust-mysql-limits-script/)
- [The build\_mysql\_conf Script](https://docs.cpanel.net/whm/scripts/the-build_mysql_conf-script/)
- [The manage\_mysql\_profiles Script](https://docs.cpanel.net/whm/scripts/the-manage_mysql_profiles-script/)
- [The MysqlDump Stream](https://docs.cpanel.net/knowledge-base/sql/the-mysqldump-stream/)
- [The cPanel Glossary](https://docs.cpanel.net/knowledge-base/cpanel-product/cpanel-glossary/)

[![](https://docs.cpanel.net/img/cpanel-logo.min.svg)](https://cpanel.com/ "WebPros International, LLC")

© 2025 All Rights Reserved / [Legal Notices](https://cpanel.com/legal-notices.html "Legal Notices") / [Privacy Policy](https://cpanel.com/privacy-policy.html "Privacy Policy") / [Transparency Report](https://cpanel.com/transparency-report.html "Transparency Report")

cPanel, WebHost Manager, and WHM are registered trademarks of WebPros International, LLC for providing its computer software that facilitates the management and configuration of internet web servers.

×