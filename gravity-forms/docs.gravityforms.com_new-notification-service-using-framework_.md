---
url: "https://docs.gravityforms.com/new-notification-service-using-framework/"
title: "Add Email Notification Service Using Add-On Framework - Gravity Forms"
---

[![Gravity Forms Documentation](https://docs.gravityforms.com/wp-content/uploads/2023/09/logo.svg)](https://docs.gravityforms.com/) [![Gravity Forms Documentation](https://docs.gravityforms.com/wp-content/uploads/2024/08/gf-print_logo.svg)](https://docs.gravityforms.com/)

- [User Guides](https://docs.gravityforms.com/category/user-guides/)
- [Developer](https://docs.gravityforms.com/category/developers/)
- [Blog](https://www.gravityforms.com/blog/)
- [Changelog](https://docs.gravityforms.com/gravityforms-change-log/)

```

```

Toggle Menu

- [Getting Started](https://docs.gravityforms.com/category/getting-started/)
- [Your Gravity Forms Account](https://docs.gravityforms.com/category/your-gravity-forms-account/)
- [User Guides](https://docs.gravityforms.com/category/user-guides/)
- [Gravity Forms 2.9](https://docs.gravityforms.com/category/gravity-forms-2-9/)
- [Gravity Forms 2.8](https://docs.gravityforms.com/category/gravity-forms-2-8/)
- [Add-Ons](https://docs.gravityforms.com/category/add-ons-gravity-forms/)
- [Developers](https://docs.gravityforms.com/category/developers/)  - [Theme Framework](https://docs.gravityforms.com/category/developers/theme-framework/)
  - [Hooks](https://docs.gravityforms.com/category/developers/hooks/)
  - [Data Objects](https://docs.gravityforms.com/category/developers/data-objects/)
  - [PHP API](https://docs.gravityforms.com/category/developers/php-api/)
  - [Database](https://docs.gravityforms.com/category/developers/database/)
  - [Developer Snippets](https://docs.gravityforms.com/category/developers/tutorials/)    - [Accessing Mapped Field Values During Feed Processing](https://docs.gravityforms.com/mapped-field-values-during-feed-processing/ "Accessing Mapped Field Values During Feed Processing")
    - [Add Sub-Pages to Gravity Forms Admin Navigation](https://docs.gravityforms.com/add-sub-pages-to-gravity-forms-admin-nav/ "Add Sub-Pages to Gravity Forms Admin Navigation")
    - [Adding a New Notification Service Using the Add-On Framework](https://docs.gravityforms.com/new-notification-service-using-framework/ "Adding a New Notification Service Using the Add-On Framework")
    - [Adding a Note to the Entry when Using the Add-On Framework](https://docs.gravityforms.com/adding-note-when-using-addon-framework/ "Adding a Note to the Entry when Using the Add-On Framework")
    - [Adding Meta Boxes to the Entry Detail Page Using the Add-On Framework](https://docs.gravityforms.com/meta-boxes-entry-detail-addon-framework/ "Adding Meta Boxes to the Entry Detail Page Using the Add-On Framework")
    - [Cancel a Stripe Subscription After a Specified Number of Payments](https://docs.gravityforms.com/cancel-stripe-subscription-payments/ "Cancel a Stripe Subscription After a Specified Number of Payments")
    - [Capturing the HTTP Referrer URL on Form Submissions](https://docs.gravityforms.com/capture-http-referrer-url-form-submissions/ "Capturing the HTTP Referrer URL on Form Submissions")
    - [Centering an Entire Form](https://docs.gravityforms.com/centering-an-entire-form/ "Centering an Entire Form")
    - [Changing Stripe Billing Information](https://docs.gravityforms.com/changing-stripe-billing-information/ "Changing Stripe Billing Information")
    - [Create a Customer in Stripe without Capturing Payment](https://docs.gravityforms.com/create-customer-stripe-without-payment/ "Create a Customer in Stripe without Capturing Payment")
    - [Create Post with Custom Taxonomy](https://docs.gravityforms.com/create-post-with-custom-taxonomy/ "Create Post with Custom Taxonomy")
    - [Defining Minimum Add-On Requirements](https://docs.gravityforms.com/defining-minimum-add-requirements/ "Defining Minimum Add-On Requirements")
    - [Deleting Cached Entry Data](https://docs.gravityforms.com/deleting-cached-entry-data/ "Deleting Cached Entry Data")
    - [Disabling Mobile Keyboard Input on Datepicker Fields](https://docs.gravityforms.com/disable-keyboard-input-datepicker-fields/ "Disabling Mobile Keyboard Input on Datepicker Fields")
    - [Display a message on the login form when the user is pending activation](https://docs.gravityforms.com/display-message-login-form-user-pending-activation/ "Display a message on the login form when the user is pending activation")
    - [Enable Use of the Total Field with Conditional Logic](https://docs.gravityforms.com/enable-total-field-with-conditional-logic/ "Enable Use of the Total Field with Conditional Logic")
    - [Hiding the Form Title](https://docs.gravityforms.com/hiding-the-form-title/ "Hiding the Form Title")
    - [Highlighting the Current or Future Date in the Datepicker](https://docs.gravityforms.com/highlighting-current-future-date-datepicker/ "Highlighting the Current or Future Date in the Datepicker")
    - [How to Add a Custom Field Group when Using the Field Framework](https://docs.gravityforms.com/add-custom-field-group-using-field-framework/ "How to Add a Custom Field Group when Using the Field Framework")
    - [How to Add a New Field to an Existing Form Using the GFAPI](https://docs.gravityforms.com/how-to-add-field-to-form-using-gfapi/ "How to Add a New Field to an Existing Form Using the GFAPI")
    - [How To Add And Remove Countries From the Address Field](https://docs.gravityforms.com/addremove-countries-country-select-field/ "How To Add And Remove Countries From the Address Field")
    - [How to Add Delayed Payment Support to a Feed Add-On](https://docs.gravityforms.com/add-delayed-payment-support-feed-add/ "How to Add Delayed Payment Support to a Feed Add-On")
    - [How to Set the Default Properties for a New Field](https://docs.gravityforms.com/set-default-properties-new-field/ "How to Set the Default Properties for a New Field")
    - [Including a New Field Using the Add-On Framework](https://docs.gravityforms.com/including-new-field-using-add-on-framework/ "Including a New Field Using the Add-On Framework")
    - [Including and Using Entry Meta with the Add-On Framework](https://docs.gravityforms.com/using-entry-meta-with-add-on-framework/ "Including and Using Entry Meta with the Add-On Framework")
    - [Including Scripts and Styles when Using the Add-On Framework](https://docs.gravityforms.com/include-scripts-styles-with-addon-framework/ "Including Scripts and Styles when Using the Add-On Framework")
    - [Sending Notifications on Custom Events when Using the Add-On Framework](https://docs.gravityforms.com/notifications-custom-events-addon-framework/ "Sending Notifications on Custom Events when Using the Add-On Framework")
    - [Using EDD Software Licensing with the Add-On Framework](https://docs.gravityforms.com/edd-software-licensing-add-on-framework/ "Using EDD Software Licensing with the Add-On Framework")
  - [REST API](https://docs.gravityforms.com/category/developers/rest-api/)
- [Knowledge Base](https://docs.gravityforms.com/category/knowledge-base/)

# Adding a New Notification Service Using the Add-On Framework

- [Introduction](https://docs.gravityforms.com/new-notification-service-using-framework/#h-introduction)
- [The Hooks](https://docs.gravityforms.com/new-notification-service-using-framework/#h-the-hooks)
- [Add the Service](https://docs.gravityforms.com/new-notification-service-using-framework/#h-add-the-service)
- [Intercept the Notification](https://docs.gravityforms.com/new-notification-service-using-framework/#h-intercept-the-notification)
- [Send the Email](https://docs.gravityforms.com/new-notification-service-using-framework/#h-send-the-email)
- [Further Reading](https://docs.gravityforms.com/new-notification-service-using-framework/#h-further-reading)

## Introduction

Gravity Forms 1.9.16 added the ability for the user to select which service to send the notification; on a default install, only WordPress (wp\_mail()) will be available.

## The Hooks

Adding a new service can be accomplished using a minimum of two hooks in the init function of your add-on.

|     |     |
| --- | --- |
| 1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11 | `/**`<br>```* Plugin starting point. Handles hooks, loading of language files, and PayPal delayed payment support.`<br>```*/`<br>`public``function``init() {`<br>``<br>```parent::init();`<br>``<br>```add_filter(``'gform_notification_services'``,``array``(``$this``,``'add_notification_service'``) );`<br>```add_filter(``'gform_pre_send_email'``,``array``(``$this``,``'maybe_send_email'``), 19, 3 );`<br>``<br>`}` |

## Add the Service

The [gform\_notification\_services](https://docs.gravityforms.com/gform_notification_services) filter adds the new choice to the “Email Service” setting on the edit notification page.

This example assumes that your add-on has an initialize\_api() function used to include the API files and connect to the service to validate any API credentials. If the credentials are valid, the choice for the new service will be added.

|     |     |
| --- | --- |
| 1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19 | `/**`<br>```* Add the new notification service.`<br>```*`<br>```* @param array $services The notification services.`<br>```*`<br>```* @return array`<br>```*/`<br>`public``function``add_notification_service(``$services``) {`<br>``<br>```// If the API can be initialized, add the service.`<br>```if``(``$this``->initialize_api() ) {`<br>```$services``[``'the_service_name'``] =``array``(`<br>```'label'``=> esc_html__(``'The Service Name'``,``'sometextdomain'``),`<br>```'image'``=>``$this``->get_base_url() .``'/images/icon.png'``,`<br>```);`<br>```}`<br>``<br>```return``$services``;`<br>`}` |

## Intercept the Notification

The [gform\_pre\_send\_email](https://docs.gravityforms.com/gform_pre_send_email) filter is used to intercept the notification email, pass the email to the new service, and then prevent WordPress and other add-ons from also sending the email.

|     |     |
| --- | --- |
| 1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32 | `/**`<br>```* If the notification "Email Service" setting is a match prepare to send the email.`<br>```*`<br>```* @param array $email The email properties.`<br>```* @param string $message_format The message format, html, or text.`<br>```* @param array $notification The Notification object which produced the current email.`<br>```*`<br>```* @return array`<br>```*/`<br>`public``function``maybe_send_email(``$email``,``$message_format``,``$notification``) {`<br>``<br>```// If the notification is not assigned to this service or the service API is not initialized, return the email.`<br>```if``( rgar(``$notification``,``'service'``) !==``'the_service_name'``|| !``$this``->initialize_api() ) {`<br>```return``$email``;`<br>```}`<br>``<br>```// If the email has already been aborted, return the email.`<br>```if``(``$email``[``'abort_email'``] ) {`<br>```$this``->log_debug(``__METHOD__``.``'(): Not sending email because the notification has already been aborted by another Add-On.'``);`<br>``<br>```return``$email``;`<br>```}`<br>``<br>```$result``=``$this``->send_email(``$email``,``$message_format``,``$notification``);`<br>``<br>```if``(``$result``) {`<br>```// The service successfully sent the email; prevent WordPress and other add-ons from also sending the email.`<br>```$email``[``'abort_email'``] = true;`<br>```}`<br>``<br>```return``$email``;`<br>`}` |

## Send the Email

Now we know that no other add-ons have already aborted the email and that this service was selected for the notification the email can be processed and passed to the service for delivery.

|     |     |
| --- | --- |
| 1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15 | `/**`<br>```* Send the email via the new service.`<br>```*`<br>```* @param array $email The email properties.`<br>```* @param string $message_format The message format, html, or text.`<br>```* @param array $notification The Notification object which produced the current email.`<br>```*`<br>```* @return bool`<br>```*/`<br>`public``function``send_email(``$email``,``$message_format``,``$notification``) {`<br>``<br>```// pass the email to the service`<br>``<br>```return``$result``;`<br>`}` |

## Further Reading

Depending on the service, you may also want to add custom settings to the notification configuration page. You can do that using the following hooks:

- [gform\_notification\_settings\_fields](https://docs.gravityforms.com/gform_notification_settings_fields/)
- [gform\_pre\_notification\_save](https://docs.gravityforms.com/gform_pre_notification_save)

Any settings added by these hooks would be available in the $notification passed to maybe\_send\_email() and send\_email().

- Comments


This field is for validation purposes and should be left unchanged.

- Was this article helpful?

- How we can improve it?

- Please [open a support ticket](https://www.gravityforms.com/open-support-ticket/) if you need technical support or want to report a bug. Product feedback, feature and integration requests, and other functionality ideas can be submitted on our [Product Roadmap page](https://www.gravityforms.com/gravity-forms-roadmap/?c=submit-idea).


Δ

Last modified: May 15, 2025

© Copyright 2008 - 2025 Rocketgenius, Inc

[Return to Gravity Forms](https://www.gravityforms.com/)

Notifications

[Algolia](https://docs.gravityforms.com/new-notification-service-using-framework/# "Algolia")

![](https://docs.gravityforms.com/wp-content/plugins/wpfront-scroll-top/includes/assets/icons/1.png)